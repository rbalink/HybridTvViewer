var GLOBALS={"baseurl":"","focusmgr":null,"demomode":null,"keyevent":"","keyeventlistener":function(c){if(GLOBALS.demomode&&(c.ctrlKey||c.altKey||c.metaKey)){return}var a=c.keyCode,b;if(!a){a=c.charCode}b=GLOBALS.focusmgr.handleKeyCode(a);if(b){c.preventDefault()}return b}};if(typeof KeyEvent!=="undefined"){if(typeof KeyEvent.VK_LEFT!=="undefined"){var VK_LEFT=KeyEvent.VK_LEFT;var VK_UP=KeyEvent.VK_UP;var VK_RIGHT=KeyEvent.VK_RIGHT;var VK_DOWN=KeyEvent.VK_DOWN}if(typeof KeyEvent.VK_ENTER!=="undefined"){var VK_ENTER=KeyEvent.VK_ENTER}if(typeof KeyEvent.VK_RED!=="undefined"){var VK_RED=KeyEvent.VK_RED;var VK_GREEN=KeyEvent.VK_GREEN;var VK_YELLOW=KeyEvent.VK_YELLOW;var VK_BLUE=KeyEvent.VK_BLUE}if(typeof KeyEvent.VK_BACK!=="undefined"){var VK_BACK=KeyEvent.VK_BACK}if(typeof KeyEvent.VK_0!=="undefined"){var VK_0=KeyEvent.VK_0;var VK_1=KeyEvent.VK_1;var VK_2=KeyEvent.VK_2;var VK_3=KeyEvent.VK_3;var VK_4=KeyEvent.VK_4;var VK_5=KeyEvent.VK_5;var VK_6=KeyEvent.VK_6;var VK_7=KeyEvent.VK_7;var VK_8=KeyEvent.VK_8;var VK_9=KeyEvent.VK_9}}if(typeof VK_LEFT==="undefined"){var VK_LEFT=37;var VK_UP=38;var VK_RIGHT=39;var VK_DOWN=40}if(typeof VK_ENTER==="undefined"){var VK_ENTER=13}if(typeof VK_RED==="undefined"){var VK_RED=116;var VK_GREEN=117;var VK_YELLOW=118;var VK_BLUE=119}if(typeof VK_BACK==="undefined"){var VK_BACK=166}if(typeof VK_0==="undefined"){var VK_0=48;var VK_1=49;var VK_2=50;var VK_3=51;var VK_4=52;var VK_5=53;var VK_6=54;var VK_7=55;var VK_8=56;var VK_9=57}function MxpFocusManager(a){this.allObjects={};this.currentFocus=null;this.hidden=true;this.keysethidden=0;this.keysets=[a];this.keysetslen=1;this.handleGlobalKey=null;this.hiddenColorKeys=[false,false,false]}MxpFocusManager.KEYSET_DISABLED=0;MxpFocusManager.KEYSET_ENABLED=1;MxpFocusManager.KEYSET_TEXTENTRY=2;MxpFocusManager.prototype.pushKeyset=function(a){this.keysets[this.keysetslen++]=a;if(!this.hidden){this.reconfigKeyset()}};MxpFocusManager.prototype.popKeyset=function(){if(this.keysetslen>1){this.keysetslen--}if(!this.hidden){this.reconfigKeyset()}};MxpFocusManager.prototype.setHidden=function(a){this.hidden=a;this.reconfigKeyset()};MxpFocusManager.prototype.reconfigKeyset=function(){this.registerKeysInternal(this.hidden?this.keysethidden:this.keysets[this.keysetslen-1])};MxpFocusManager.prototype.calculateKeyMaskInternal=function(b){var c,a=1;if(b>0){a+=2+4+8+16;if(b>1){a+=256}}else{for(c=0;c<3;c++){if(this.hiddenColorKeys[c]){a+=2<<c}}}return a};MxpFocusManager.prototype.registerKeysInternal=function(b){var a=this.calculateKeyMaskInternal(b);try{var f=document.getElementById("appmgr").getOwnerApplication(document);f.privateData.keyset.setValue(a)}catch(d){}try{document.getElementById("oipfcfg").keyset.value=a}catch(c){}};MxpFocusManager.prototype.getObject=function(a){return this.allObjects[a]};MxpFocusManager.prototype.focusObject=function(b){if(this.currentFocus&&this.currentFocus.idnam===b){return}var d=this.currentFocus;var a=this.allObjects[b];if(d){d.setFocused(a,false)}d=this.currentFocus;this.currentFocus=a||null;if(a){a.setFocused(d,true)}if(this.onFocusChange){try{this.onFocusChange(d,a)}catch(c){}}};MxpFocusManager.prototype.handleKeyCode=function(a){if(this.hidden){if(this.handleGlobalKey&&this.handleGlobalKey(a)){return true}return false}if(this.currentFocus&&this.currentFocus.handleKeyPress(a)){return true}if(this.handleGlobalKey&&this.handleGlobalKey(a)){return true}if(a===VK_LEFT||a===VK_RIGHT||a===VK_UP||a===VK_DOWN||a===VK_ENTER){return true}return false};function MxpHideManager(a,b){this.hidemsgtimer=null;this.hidemsgelem=a?document.getElementById(a):null;this.appscreenelem=b?document.getElementById(b):null;this.hidemsgtimeout=7000}MxpHideManager.prototype.setHidden=function(c,d){if(this.hidemsgtimer){clearTimeout(this.hidemsgtimer);this.hidemsgtimer=null}GLOBALS.focusmgr.setHidden(c);if(this.appscreenelem){this.appscreenelem.style.visibility=c?"hidden":"inherit"}if(this.hidemsgelem){this.hidemsgelem.style.visibility=c?"inherit":"hidden";if(c){var b=this;var a=d||this.hidemsgtimeout;this.hidemsgtimer=setTimeout(function(){b.hidemsgtimer=null;b.hidemsgelem.style.visibility="hidden"},a)}}};function MxpBaseObject(){}MxpBaseObject.prototype.baseInit=function(a){this.elem=a;GLOBALS.focusmgr.allObjects[this.idnam]=this};MxpBaseObject.prototype.setFocused=function(a,b){};MxpBaseObject.prototype.requestFocus=function(){GLOBALS.focusmgr.focusObject(this.idnam)};MxpBaseObject.prototype.handleKeyPress=function(a){return false};function initHbbTV(a){try{if(navigator&&navigator.appVersion&&navigator.appVersion.indexOf("PHILIPS_OLS_")>0){if(GLOBALS.keyevent===""){GLOBALS.keyevent="keypress"}}}catch(b){}if(GLOBALS.keyevent===""){GLOBALS.keyevent="keydown"}GLOBALS.focusmgr=new MxpFocusManager(a);document.addEventListener(GLOBALS.keyevent,GLOBALS.keyeventlistener,false)}function closeHbbTV(){try{document.removeEventListener(GLOBALS.keyevent,GLOBALS.keyeventlistener,false)}catch(b){}try{GLOBALS.focusmgr.allObjects=null;GLOBALS.focusmgr.focusableObjects=null}catch(a){}GLOBALS.focusmgr=null;GLOBALS.videohandler=null;GLOBALS.keyeventlistener=null}function showApplication(){try{var c=document.getElementById("appmgr").getOwnerApplication(document);c.show();c.activate()}catch(b){}try{c.show()}catch(a){}}function shortenText(a,c){if(a.length<c){return a}if(c<5){return""}a=a.substring(0,c-3);var b=a.lastIndexOf(" ");if(b>0){a=a.substring(0,b+1)}return a+"..."}function textHtmlEncode(a,b){a=toStr(a).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;");if(b){a=a.replace(/\n/g,"<br />")}return a}function createClassDiv(a,d,c){var b=document.createElement("div");if(a!==false){b.style.left=a+"px"}if(d!==false){b.style.top=d+"px"}b.className=c;return b}function buildCssUrl(a,b){if(!a){return""}if(b){a=a.replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\"/g,"%22").replace(/'/g,"%27")}return'url("'+a+'")'}function toStr(a){return""+a}function abortHttpRequest(a){if(a){try{a.abort()}catch(b){}}}function createHttpRequest(b,h,a){var c=new XMLHttpRequest();if(h){c.onreadystatechange=function(){if(c.readyState!==4){return}if(h){try{if(c.status>=200&&c.status<300){h(c.responseText)}else{h(null,c)}}catch(i){if(console&&console.log){console.log("Error while processing URL "+b+": "+i+" - Result was: "+c.status+"/"+c.responseText);console.log(i)}}}c.onreadystatechange=null;c=null;h=null}}if(GLOBALS.baseurl&&b.indexOf(":/")<1){b=GLOBALS.baseurl+b}try{c.open((a?a.method:null)||"GET",b,true);if(!a||!a.dosend){c.send(null)}else{a.dosend(c)}}catch(f){try{c.onreadystatechange=null;if(GLOBALS.demomode&&console&&console.log){console.log(["Cannot open URL "+b,f])}}catch(g){}try{h(null)}catch(d){}c=null}return c}function parseJSON(txt){if(!txt){return null}var startpos=0,endpos=txt.length-1,fchar,lchar;while(startpos+1<endpos&&txt.charCodeAt(startpos)<33){startpos++}while(endpos-1>startpos&&txt.charCodeAt(endpos)<33){endpos--}fchar=txt.substring(startpos,startpos+1);lchar=txt.substring(endpos,endpos+1);if((fchar==="["&&lchar==="]")||(fchar==="{"&&lchar==="}")){txt=txt.substring(startpos,endpos+1);try{if(JSON&&JSON.parse){try{return JSON.parse(txt)}catch(innere){return null}}}catch(e){}try{return eval("("+txt+")")}catch(e){}}return null}function MxpCookieManager(b,a,c,d){this.cookiename=b||"settings";this.cookiepath=d||null;this.defaultVersion=a||1;this.saveDays=c||365;this.info={};this.specialTypes={};this.defaults=null;this.foundCookie=false;this.setCookieScript=null;this.uastr="";try{if(navigator){this.uastr=(navigator.appName||"")+(navigator.appVersion||"")+(navigator.userAgent||"");this.uastr=this.uastr.toUpperCase()}}catch(e){}}MxpCookieManager.createStart=function(b){var a=new MxpCookieManager("ardstart",3,365,b);a.setCookieScript="setcookie.php";a.loadCookie({"fsize":0,"nobg":0,"rbp":0,"rangeid":0,"subtitcfg":0,"langcfg":"","ra":0,"rb":0,"rc":0,"xcfg":0,"u":"0"},{"u":"txt","langcfg":"txt"});return a};MxpCookieManager.prototype.resetToDefaults=function(){if(this.defaults){this.info=this.cloneObj(this.defaults)}};MxpCookieManager.prototype.loadCookie=function(f,a){var h,g,b,k,c,d=0,m=0;if(!f){f={}}f.v=this.defaultVersion;f.ts=0;f.cookies=0;this.defaults=f;this.resetToDefaults();if(!a){a={}}this.specialTypes=a;this.foundCookie=false;try{k=document.cookie.split(";");for(h=0;h<k.length;h++){g=k[h].indexOf("=");b=0;while(g>0&&b<k[h].length&&k[h].substring(b,b+1)===" "){b++}if(g>0&&this.cookiename===k[h].substring(b,g)){c=this.parseCookie(decodeURIComponent(k[h].substring(g+1)));if(c&&(c.v>d||(c.ts>m&&c.v===d))){this.foundCookie=1;d=c.v;m=c.ts;this.info=c}}}}catch(l){}try{if(localStorage&&localStorage.setItem){k=localStorage.getItem(this.cookiename)||"";c=k?this.parseCookie(k):null;if(c&&(c.v>d||(c.ts>m&&c.v===d))){this.foundCookie=2;d=c.v;m=c.ts;this.info=c}}}catch(l){}};MxpCookieManager.prototype.encodeValue=function(){var d,c="",b,e,a;a=(this.info.cookies&1)===0;for(d in this.info){if(!this.info.hasOwnProperty(d)){continue}if("ts"===d){continue}b=this.info[d];if(d&&b&&(a||d==="cookies"||d==="v")){e=this.specialTypes[d]||"";if("obj"===e){b=this.encodeObj(b)}else{b=this.fixStr(""+b)}c+=(c?"*":"")+d+"*"+b}}c+=(c?"*":"")+"ts*"+Math.round(new Date().getTime()/100000);return c};MxpCookieManager.prototype.saveCookie=function(c){var f,b,a=this.encodeValue();try{if(localStorage&&localStorage.setItem){localStorage.setItem(this.cookiename,a)}}catch(d){}try{f=new Date((new Date()).getTime()+this.saveDays*24*3600000);try{f=f.toUTCString()}catch(g){f=f.toGMTString()}a=encodeURIComponent(a);b=this.cookiename+"="+a+";expires="+f;if(this.cookiepath){b+=";path="+this.cookiepath}document.cookie=b;if(this.setCookieScript&&!c&&this.uastr.indexOf("HUMAX")>0){b=new XMLHttpRequest();b.open("GET",(this.cookiepath||"")+this.setCookieScript+"?val="+a+"&name="+this.cookiename);b.send(null)}}catch(d){}};MxpCookieManager.prototype.fixStr=function(a){var d,f,e,b="";a=""+a;for(d=0;d<a.length;d++){f=a.substring(d,d+1);e=f.charCodeAt(0);if(e>64||e===32||e===45||e===46||(e>=48&&e<=57)){b+=f}}return b};MxpCookieManager.prototype.decodeObj=function(a){var f,c,b,g,e={};g=a.split(",");for(f=0;f+1<g.length;f+=2){c=this.fixStr(g[f]);b=this.fixStr(g[f+1]);if(c&&b){e[c]=b}}return e};MxpCookieManager.prototype.encodeObj=function(b){var d,a,c="";for(d in b){if(!b.hasOwnProperty(d)){continue}a=b[d];c+=(c===""?"":",")+this.fixStr(d)+","+this.fixStr(a)}return c===""?"0":c};MxpCookieManager.prototype.cloneObj=function(a){if(null===a||"object"!==typeof a){return a}var c,b={};for(c in a){if(a.hasOwnProperty(c)){b[c]=this.cloneObj(a[c])}}return b};MxpCookieManager.prototype.parseCookie=function(a){var f,c,b,g,d;a=a.split("*");d=this.cloneObj(this.defaults);d.v=d.ts=0;for(f=0;f+1<a.length;f+=2){try{c=a[f];if(!d.hasOwnProperty(c)){continue}g=this.specialTypes[c]||"";b=a[f+1];if("txt"===g){b=this.fixStr(b)}else{if("obj"===g){b=this.decodeObj(b)}else{b=parseInt(b,10);if(isNaN(b)){continue}}}d[c]=b}catch(h){}}if(!d.v){return null}return d};function MxpSubtitle(g){var a,f,c,b;this.cfg={"isenabled":0,"fontsize":0,"disptype":0,"position":0};this.fontsizes=[40,30,50,56];this.lastsubtitle="##";this.elem=document.getElementById("subcontainer");this.videlem=document.getElementById("video");this.vidbackelem=document.getElementById("videoback");this.isseventregistered=false;this.isvidfullscreen=true;this.vidfstype=-1;this.handlerRegisteredStreamId=-1;this.lastsubtitlereceived=0;this.delayms=0;this.lastData=null;this.registersevents=g;this.characterConversionTable={167:"&"+"#x00A7;",176:"&"+"#x00B0;",228:"&"+"#x00E4;",246:"&"+"#x00F6;",252:"&"+"#x00FC;",196:"&"+"#x00C4;",214:"&"+"#x00D6;",220:"&"+"#x00DC;",223:"&"+"#x00DF;",134:"&"+"#x2587;"};b=this;this.seventHandler=function(j){if(j&&j.data&&j.data.length>3&&"trigger"===j.status){var i,h=j.data;if(h===b.lastData){return}b.lastData=h;try{i=parseInt(h.substring(0,4),16);if(i===22616){b.decodeSpecialEvent(h.substring(4));return}}catch(k){return}if(b.timer||!b.delayms){b.decodeEvent(h)}else{setTimeout(function(){b.decodeEvent(h)},b.delayms)}}};this.timer=null;c=document.createElement("div");c.className="subblock";this.subdivs=[c];for(f=0;f<3;f++){for(a=0;a<3;a++){if(a===1&&f===1){continue}c=document.createElement("div");c.className="suboutline";c.style.left=(a*2-2)+"px";c.style.top=(f*2-2)+"px";this.subdivs.push(c)}}c=document.createElement("div");c.className="subtext";this.subdivs.push(c);if(this.elem){for(a=0;a<this.subdivs.length;a++){this.elem.appendChild(this.subdivs[a])}}try{this.configureInternal();this.setWaitingText()}catch(d){}}MxpSubtitle.prototype.setDelay=function(a){if(isNaN(a)){this.delayms=0}else{this.delayms=Math.max(0,Math.min(10000,a))}};MxpSubtitle.prototype.setWaitingText=function(){this.setText("ll",["",""]);var a=this;this.timer=setTimeout(function(){a.timer=null;a.setTimeoutText()},45000)};MxpSubtitle.prototype.setTimeoutText=function(){if(this.handlerRegisteredStreamId<=0){return}this.setText("ll",["Ihr Endgerät unterstützt leider keine","Untertitel nach dem HbbTV-Standard."]);var a=this;this.timer=setTimeout(function(){a.timer=null;a.setConfig(0,-1)},5000)};MxpSubtitle.prototype.setConfig=function(a,b){if(this.timer){clearTimeout(this.timer);this.timer=null}a=isNaN(a)?0:a;this.cfg.isenabled=(a&1)===1&&!isNaN(b)&&b>0;this.cfg.fontsize=(a>>1)&3;this.cfg.disptype=(a>>3)&3;this.cfg.position=(a>>5)&1;this.lastsubtitlereceived=0;this.handlerRegisteredStreamId=(this.cfg.isenabled&&this.registersevents&&b>0)?b:-1;try{this.configureInternal()}catch(d){}if(!this.registersevents||this.isseventregistered||(this.handlerRegisteredStreamId<=0&&this.registersevents!==2)){return}try{if(this.handlerRegisteredStreamId>0){this.setWaitingText()}this.videlem.addStreamEventListener("sevent.xml","subtit",this.seventHandler);this.isseventregistered=true}catch(c){this.setTimeoutText()}};MxpSubtitle.prototype.unregister=function(){this.setConfig(0,-1);if(this.isseventregistered){try{this.videlem.removeStreamEventListener("sevent.xml","subtit",this.seventHandler)}catch(b){}try{this.videlem.removeStreamEventListener(this.seventHandler)}catch(a){}this.isseventregistered=false}this.handlerRegisteredStreamId=-1;this.registersevents=false};MxpSubtitle.prototype.configureInternal=function(){var b=this.fontsizes[this.cfg.fontsize];var a=!this.cfg.isenabled||this.cfg.disptype!==2;var d=Math.floor(b*1.3);this.elem.style.display=this.cfg.isenabled?"block":"none";this.elem.className="subtype"+(this.cfg.disptype===1?"outline":"block");this.elem.style.fontSize=b+"px";this.elem.style.lineHeight=d+"px";this.totalheight=d*2;this.elem.style.top=(this.cfg.position===1?36:720-36-this.totalheight)+"px";this.elem.style.height=this.totalheight+"px";if(a&&this.isvidfullscreen){return}this.isvidfullscreen=a;if(this.vidbackelem){this.vidbackelem.style.display=a?"none":"block"}this.vidfstype=-1;this.updateVideoSize();if(this.registersevents){try{this.videlem.setFullScreen(a)}catch(c){}}};MxpSubtitle.prototype.updateVideoSize=function(){var b,a,c,e,d=this.isvidfullscreen?1:0;if(d===0&&this.lastsubtitle.substring(this.lastsubtitle.length-2)==="##"&&this.lastsubtitlereceived<(new Date()).getTime()-60000){d=1}if(d===this.vidfstype){return}this.vidfstype=d;if(d){b=a=0;c=1280;e=720}else{e=720-30-36-this.totalheight;e-=(e%2);a=this.cfg.position===1?36+this.totalheight+5:30-5;c=Math.floor(e*16/9+0.5);b=Math.floor((1280-c)/2)}this.applyVideoSizeInternal(b,a,c,e)};MxpSubtitle.prototype.applyVideoSizeInternal=function(b,a,c,d){this.videlem.width=c;this.videlem.height=d;this.videlem.style.left=b+"px";this.videlem.style.top=a+"px";this.videlem.style.width=c+"px";this.videlem.style.height=d+"px"};MxpSubtitle.prototype.decodeSpecialEvent=function(e){var b,c,f=false,a="",d=this;for(b=0;b+1<e.length;b+=2){try{c=parseInt(e.substr(b,2),16);if(c>32&&c<127){a+=String.fromCharCode(c)}}catch(g){}}a=a.split(",");if(!a.length||a[0]!=="CU"||!GLOBALS||!GLOBALS.video||!GLOBALS.video.sId){return}for(b=1;b<a.length;b++){c=parseInt(a[b],10);if(c===GLOBALS.video.sId){f=true;break}}if(!f){return}if(this.loadConfigTimer){clearTimeout(this.loadConfigTimer)}this.loadConfigTimer=setTimeout(function(){d.loadConfigTimer=null;GLOBALS.config.loadConfig(false)},5000+Math.floor(Math.random()*4000))};MxpSubtitle.prototype.decodeEvent=function(d){var b,c,f=true,a=[""];if(this.timer){this.setText("ll",["",""])}if(this.handlerRegisteredStreamId<0){return}for(b=0;b+1<d.length;b+=2){try{c=parseInt(d.substr(b,2),16)}catch(g){continue}if(c<128){switch(c){case 9:if(f){if(this.validateStreamId(a[0])){f=false;a[0]=""}else{b=d.length}}else{a.push("")}c="";break;case 60:c="&lt;";break;case 62:c="&gt;";break;case 34:c="&quot;";break;case 38:c="&amp;";break;default:c=String.fromCharCode(c)}}else{if(this.characterConversionTable[c]){c=this.characterConversionTable[c]}else{continue}}a[a.length-1]+=c}if(f){if(this.vidfstype===0){this.updateVideoSize()}return}while(a.length<3){a.push("")}this.lastsubtitlereceived=(new Date()).getTime();this.setText(a[0],[a[1],a[2]])};MxpSubtitle.prototype.validateStreamId=function(b){var a,c=b.split(",");if(28221===this.handlerRegisteredStreamId){return true}for(a=0;a<c.length;a++){if(parseInt(c[a],16)===this.handlerRegisteredStreamId){return true}}return false};MxpSubtitle.prototype.setText=function(c,a){var b="##";if(this.timer){clearTimeout(this.timer);this.timer=null}try{b=c+"#"+a[0]+"#"+a[1]}catch(e){}if(!this.cfg.isenabled||b===this.lastsubtitle){return}this.lastsubtitle=b;try{this.setTextInternal(c,a);this.updateVideoSize()}catch(d){}};MxpSubtitle.prototype.setTextInternal=function(e,b){var c="",a,d;for(d=0;d<b.length;d++){a=b[d];if(a===""){if(d>0||this.cfg.position===1){continue}a='<span class="cc0">&#160;</span>'}else{a=this.textToSpans(a)}c+='<div class="subline'+e.substring(d,d+1)+'">'+a+"</div>"}for(d=0;d<this.subdivs.length;d++){this.subdivs[d].innerHTML=c}};MxpSubtitle.prototype.textToSpans=function(l){var h="",b=true,a=7,e=0,f,k;var g=-1;var j=[],d=[];for(f=0;f<l.length;f++){k=l.charCodeAt(f);if(k>=0&&k<=7){a=k;b=true}else{if(k>=16&&k<=23){e=k-16;b=true}else{if(b){j[++g]="";d[g]=" fgcol"+a+" bgcol"+e;b=false}if(k===32){j[g]+="&#160;"}else{j[g]+=l.substring(f,f+1)}}}}for(f=0;f<j.length;f++){k=(f===0?1:0)+(f===j.length-1?2:0);h+='<span class="cc'+k+d[f]+'">'+j[f]+"</span>"}return h};var vidstreaming={};function MxpStats(){var b,a,c=document.getElementById("cpix");this.appbase="http://itv.ard.de/ardstart/";this.statbase="http://itv.ard.de/stat/p.png?app=";this.webavailable=!GLOBALS.dsmccversion;this.eitsupported=false;this.cookies=MxpCookieManager.createStart(GLOBALS.cookiepath||null);this.rbpTrackCfg=2+4+8+16+32;this.trackCfg=this.cookies.info.rbp?this.cookies.info.cookies:this.rbpTrackCfg;this.uagent="$ $ $$$$";this.ridxNames=["ra","rb","rc"];try{if(navigator){this.uagent="$"+(navigator.appName||" ")+"$"+(navigator.appVersion||" ")+"$$"+(navigator.userAgent||"")+"$$"}}catch(d){}this.cpix=[];this.cpixidx=0;for(b=0;b<5;b++){a=document.createElement("img");a.className="cpix";this.cpix.push(a);if(c){c.appendChild(a)}}}MxpStats.loadScript=function(c){var b,a=document.getElementsByTagName("head")[0];if(GLOBALS.dsmccversion||!a){return null}b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("src",c);a.appendChild(b);return b};MxpStats.prototype.init=function(){this.enableAnimation();this.updateFSize()};MxpStats.prototype.isSEventSupport=function(){var b,a;try{if(!this.uagent||GLOBALS.dsmccversion){return false}if(GLOBALS.anydev){return true}a=this.uagent.toUpperCase();b=a.indexOf("HBBTV/");if(b<=0){return false}a=a.substring(b+6,b+16).split(".");a[0]=a.length<1?0:parseInt(a[0],10);a[1]=a.length<2?0:parseInt(a[1],10);return a[0]>1||(a[0]===1&&a[1]>=1)}catch(c){return false}};MxpStats.prototype.enableAnimation=function(){var a,c,b;try{if(!this.uagent||GLOBALS.dsmccversion){return}a=this.uagent.toUpperCase();if(a.indexOf("MAPLE")>=0||(a.indexOf("SAMSUNG")>=0&&(a.indexOf("SMARTTV2012")>=0||a.indexOf("SMARTTV2013")>=0||a.indexOf("SMARTTV2014")>=0)||a.indexOf("SMARTTV2015")>=0)){return}if(!GLOBALS.htmlfive&&!GLOBALS.anydev&&a.indexOf("HBBTV/1.1")>=0&&a.indexOf("PANASONIC")<0){return}c=document.getElementsByTagName("head")[0];if(!c){return}b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",(GLOBALS.appdir||"")+"style/anim.css");c.appendChild(b)}catch(d){}};MxpStats.prototype.setFSize=function(a){var b=this;this.cookies.info.fsize=a;this.updateFSize();setTimeout(function(){b.cookies.saveCookie(GLOBALS.dsmccversion)},3000)};MxpStats.prototype.updateFSize=function(){var b="fullscrn",a=this.cookies.info.fsize;if(a===1){b+=" lgfont"}else{if(a===2){b+=" cntrst"}else{if(a===3){b+=" lgfont cntrst forall"}}}GLOBALS.hidemgr.appscreenelem.className=b};MxpStats.prototype.isForAll=function(){return this.cookies.info.fsize===3};MxpStats.prototype.isLargeFont=function(){return this.cookies.info.fsize===1||this.isForAll()};MxpStats.prototype.isCookieAllowed=function(a){return(this.trackCfg&a)===0};MxpStats.prototype.isFunctionCookieAllowed=function(){return this.isCookieAllowed(1)};MxpStats.prototype.isStatisticsAllowed=function(a){if(GLOBALS.dsmccversion){return false}if(a==="logstat"){return this.isCookieAllowed(8)}if(a==="ivw"){return this.isCookieAllowed(2)}if(a==="ati"){return this.isCookieAllowed(4)}if(a==="nielsen"){return this.isCookieAllowed(32)}return false};MxpStats.prototype.findStatRangeIdOld=function(){var c,a,d,b=parseInt(GLOBALS.rangeids[4],10);if(!b||b<202000){return false}d=b-100;for(c=0;c<this.ridxNames.length;c++){a=this.ridxNames[c];a=parseInt(this.cookies.info[a],10);if(!isNaN(a)&&a>d&&a<=b){return true}}return false};MxpStats.prototype.findStatRangeId=function(d,b){var c,a;for(c=0;c<this.ridxNames.length;c++){a=this.ridxNames[c];a=this.cookies.info[a];if(a===d||a===b){return true}}return false};MxpStats.prototype.manageStatistics=function(){var e,c,a=3,b=true;try{if(this.cookies.info.rangeid===GLOBALS.rangeids[0]){a=1;b=false}else{if(this.cookies.info.rangeid===GLOBALS.rangeids[1]){a=2}else{if(this.cookies.info.rangeid===GLOBALS.rangeids[3]){a=this.findStatRangeIdOld()?4:5}}}}catch(d){}this.cookies.info.rangeid=GLOBALS.rangeids[0];c=a===1||a===2||a===4;try{e=(GLOBALS.rangeids[0]%100)%this.ridxNames.length;e=this.ridxNames[e||0];if(GLOBALS.rangeids[2]&&this.cookies.info[e]!==GLOBALS.rangeids[0]){this.cookies.info[e]=GLOBALS.rangeids[0];b=true}if(c){if(this.findStatRangeId(GLOBALS.rangeids[1],GLOBALS.rangeids[3])){a+=10}a+=((GLOBALS.stats.cookies.info.subtitcfg&1)===1)?100:200;if(GLOBALS.stats.cookies.info.langcfg&&GLOBALS.stats.cookies.info.langcfg!=="deu"){a+=400}}}catch(d){}this.logstat(a,0);if(b){this.cookies.saveCookie(GLOBALS.dsmccversion)}};MxpStats.prototype.generateUid=function(){var d,b,a,c="",e="01234567890abcdefghijklmnopqrstuvwxyz";try{a=e.length;for(d=0;d<22;d++){b=Math.max(0,Math.min(a-1,Math.floor(Math.random()*a)));c+=e.substring(b,b+1)}}catch(f){}return c};MxpStats.prototype.logstat=function(j,i,d){var c,a,g,b,h;try{h=this.isStatisticsAllowed("logstat");if(!GLOBALS.stats.webavailable||(i!==0&&!h)){if(d){d()}return}if(h&&(!this.cookies.info.u||this.cookies.info.u==="0")&&!GLOBALS.dsmccversion){this.cookies.info.u=this.generateUid();this.cookies.saveCookie(GLOBALS.dsmccversion)}c=GLOBALS.video.serviceidsd;if(!svcinfo[toStr(c)]||j===-1||i===0||!h){c=0}g="&sid="+c+"&sub="+(h?j:(j%100))+"&delivery="+(h?(GLOBALS.video.servicedelivery||1):0)+"&uid="+(h?encodeURIComponent(""+this.cookies.info.u):"")+(h?"&d="+Math.floor(Math.random()*100000)+"."+(new Date()).getTime():"");a=this.statbase+i+g;b=this.cpix[(this.cpixidx++)%this.cpix.length];if(i<2||d){if(d){b.onload=function(){b.onload=null;setTimeout(function(){d()},100)}}else{b.onload=null}b.src=a;if(d){setTimeout(function(){if(b.onload){b.onload=null;d()}},10000)}}else{b.src=a}}catch(f){if(d){d()}}};MxpStats.prototype.loadIVW=function(i,e){if(this.isStatisticsAllowed("ati")){try{var b="http://logc406.xiti.com/hit.xiti?"+(GLOBALS.staging?"s=554666&s2=7":"s=554666&s2=3");var c=GLOBALS.time.getNow();var g=c.getHours();var f=c.getMinutes();var a=c.getSeconds();var d=g+"x"+f+"x"+a;b+="&ts="+c.getTime()+"&vtag=5.6.1&ptag=js&r=1280x720x24x24&re=1280x720&p="+i+"&hl="+d+"&lng=de";if(e){b+="&clic="+(e==="action"?"A":"N")+"&pclick=&s2click=&idclient=Consent-NO"}else{b+="&idpays=DE&idp="+(g<10?"0":"")+g+(f<10?"0":"")+f+(a<10?"0":"")+a+Math.floor(Math.random()*10000000)+"&jv=0";if(GLOBALS.video.serviceidsd){b+="&tag="+encodeURIComponent("["+GLOBALS.video.servicename+"]")}b+="&idclient=Consent-NO&ref="}d=this.cpix[(this.cpixidx++)%this.cpix.length];d.src=b}catch(h){}}};MxpStats.prototype.debugPrintKeys=function(){var b,a;try{a=document.getElementsByTagName("body")[0];if(!a){return null}b=createClassDiv(false,36,"debug");b.style.width="inherit";b.innerHTML="Tasten-Test";a.appendChild(b);GLOBALS.focusmgr.keysethidden=1;GLOBALS.focusmgr.handleKeyCode=function(d){b.innerHTML="Key = "+d;return MxpFocusManager.prototype.handleKeyCode.call(GLOBALS.focusmgr,d)}}catch(c){}};function MxpParams(){this.hashparams=this.parseHash();if(this.hashparams.autoshow||this.hashparams.privacy){GLOBALS.autoshow=true}if(this.hashparams.testapps){GLOBALS.showtest=true}if(this.hashparams.sevent){GLOBALS.streamEventSupport=parseInt(this.hashparams.sevent,10)}if(isNaN(GLOBALS.streamEventSupport)){GLOBALS.streamEventSupport=0}this.showtest=GLOBALS.showtest||false}MxpParams.prototype.parseHash=function(){var a={},b,f,d,c;try{if(!window.location||!window.location.hash){return a}c=window.location.hash.split(",");for(b=0;b<c.length;b++){f=c[b].split("=");d=f[0];if(d&&d.substring(0,1)==="#"){d=d.substring(1)}if(d){a[d]=f[1]||1}}}catch(e){}return a};function MxpOverlay(){}MxpOverlay.prototype.initOverlay=function(){this.overlaydata={"sid":0,"curSlide":-1,"slides":[],"xtraHtml":"","lastImgUrl":"","lastText":"","lastXtraHtml":"","randomDelay":Math.round(7*Math.random())};this.radioimgElem=document.getElementById("radioimg");this.loadingElem=document.createElement("div");this.loadingElem.className="loading";if(this.radioimgElem){this.radioimgElem.appendChild(this.loadingElem)}this.overlayElem=document.getElementById("overlaydiv");this.xtraOverlayElem=document.getElementById("xtraoverlaydiv")||document.createElement("div")};MxpOverlay.prototype.setOverlayId=function(a,b){if(a===this.overlaydata.sid){return}if(this.overlaydata.reqtimr){clearTimeout(this.overlaydata.reqtimr);this.overlaydata.reqtimr=null}if(this.overlaydata.timr){clearTimeout(this.overlaydata.timr);this.overlaydata.timr=null}this.overlaydata.sid=a||0;this.overlaydata.backgroundImageUrl=b||"";this.overlayElem.innerHTML=this.overlaydata.lastImgUrl=this.overlaydata.lastText="";this.xtraOverlayElem.innerHTML=this.overlaydata.xtraHtml=this.overlaydata.lastXtraHtml="";this.overlaydata.slides=[];this.overlaydata.curSlide=-1;this.overlaydata.errCnt=0;this.overlayElem.style.display=this.overlaydata.sid?"block":"none";this.xtraOverlayElem.style.display=this.overlaydata.sid?"block":"none";this.reloadOverlayData();this.clearRadioimgElem();this.setOverlayBackgroundImage(this.overlaydata.backgroundImageUrl)};MxpOverlay.prototype.clearRadioimgElem=function(){var a;while(this.radioimgElem.firstChild&&this.radioimgElem.firstChild.nodeName){a=""+this.radioimgElem.firstChild.nodeName;if("img"!==a.toLowerCase()){break}this.radioimgElem.removeChild(this.radioimgElem.firstChild)}};MxpOverlay.prototype.setOverlayBackgroundImage=function(d){var a,c,g,b=this.overlaydata.sid,f=this;if(this.overlaydata.lastImgUrl===d||!b){return}this.overlaydata.lastImgUrl=d;if(!this.overlaydata.hasAnim){this.overlaydata.hasAnim=-1;try{a=this.getUserAgentString();if(a.indexOf("SMARTTV2013")<0&&a.indexOf("SMARTTV2012")<0&&a.indexOf("MAPLE")<0){this.overlaydata.hasAnim=1}}catch(h){}}d=d||(this.overlaydata.backgroundImageUrl||"");c=this.radioimgElem;if(this.overlaydata.hasAnim<1){c.style.backgroundImage=d?buildCssUrl(d):"none";return}this.clearRadioimgElem();if(!d){return}g=document.createElement("img");g.className="fadeimg";g.onload=function(){g.onload=null;if(b!==f.overlaydata.sid){return}g.style.WebkitTransition=g.style.transition="opacity 2.0s ease-in-out";setTimeout(function(){g.style.opacity="1"},100);setTimeout(function(){if(b!==f.overlaydata.sid){return}c.style.backgroundImage=buildCssUrl(d)},3000)};g.src=d;c.insertBefore(g,c.firstChild)};MxpOverlay.prototype.setOverlaySlide=function(a){var b;if(!a){return}if(a.html!==this.overlaydata.lastText){this.overlaydata.lastText=a.html;try{this.overlayElem.innerHTML=a.html||""}catch(c){}}b=a.showOverlayHtml!==false?this.overlaydata.xtraHtml:"";if(b!==this.overlaydata.lastXtraHtml){this.overlaydata.lastXtraHtml=b;try{this.xtraOverlayElem.innerHTML=b}catch(c){}}this.setOverlayBackgroundImage(a.backgroundImage||"")};MxpOverlay.prototype.updateOverlay=function(){var d=this,b,a,c;if(this.overlaydata.timr){clearTimeout(this.overlaydata.timr);this.overlaydata.timr=null}if(!this.overlaydata.sid||!this.overlaydata.slides.length){this.setOverlaySlide({});return}this.overlaydata.curSlide++;if(this.overlaydata.curSlide>=this.overlaydata.slides.length){this.overlaydata.curSlide=0}a=this.overlaydata.slides[this.overlaydata.curSlide]||{};this.setOverlaySlide(a);b=Math.max(5,Math.min(600,(a.updateDelay||30)))*1000;c=new Date();this.overlaydata.nextChange=c.getTime()+b;this.overlaydata.timr=setTimeout(function(){d.overlaydata.timr=null;d.updateOverlay()},b)};MxpOverlay.prototype.fixOverlayImg=function(a){if(!this.overlayApiUrl||!a){return a}return a.replace(/api\/overlayimg\.php/g,this.overlayApiUrl+"overlayimg.php")};MxpOverlay.prototype.getFeedUrl=function(){return(this.overlayApiUrl||"api/")+"overlay.php?sid="+this.overlaydata.sid};MxpOverlay.prototype.reloadOverlayData=function(){var b=this,a=0;if(this.overlaydata.reqtimr){clearTimeout(this.overlaydata.reqtimr);this.overlaydata.reqtimr=null}abortHttpRequest(this.overlaydata.datareq);if(!this.overlaydata.sid){return}try{this.overlaydata.datareq=createHttpRequest(this.getFeedUrl(),function(f){var g,h,e;f=f?parseJSON(f):null;if(!f||!f.slides||!f.slides.length){b.overlaydata.errCnt=(b.overlaydata.errCnt||0)+1;if(b.overlaydata.errCnt===3){b.overlaydata.slides=[];b.setOverlaySlide({});if(b.overlaydata.timr){clearTimeout(b.overlaydata.timr);b.overlaydata.timr=null}}return}b.overlaydata.errCnt=0;h=b.overlaydata.curSlide>=0&&b.overlaydata.curSlide<b.overlaydata.slides.length?b.overlaydata.slides[b.overlaydata.curSlide]:null;e=h?h.key:null;b.overlaydata.xtraHtml=b.fixOverlayImg(f.overlayHtml)||"";b.overlaydata.slides=f.slides;if(e){b.overlaydata.curSlide=-1;for(g=0;g<f.slides.length;g++){h=f.slides[g];if(h.key===e){b.overlaydata.curSlide=g;break}}}if(b.overlayApiUrl){for(g=0;g<f.slides.length;g++){h=f.slides[g];h.html=b.fixOverlayImg(h.html);h.backgroundImage=b.fixOverlayImg(h.backgroundImage)}}if(!b.overlaydata.timr){b.updateOverlay()}else{if(b.overlaydata.timr&&e&&b.overlaydata.curSlide>=0){g=new Date();g=g.getTime();if(g+5000<b.overlaydata.nextChange){b.setOverlaySlide(b.overlaydata.slides[b.overlaydata.curSlide])}}}})}catch(c){}a=Math.round(this.getNowUtcMillis()/1000)%30;a=45-a+(this.overlaydata.randomDelay||0);this.overlaydata.reqtimr=setTimeout(function(){b.overlaydata.reqtimr=null;b.reloadOverlayData()},a*1000)};MxpOverlay.prototype.getUserAgentString=function(){return""};MxpOverlay.prototype.getNowUtcMillis=function(){return((new Date()).getTime())};function MxpVideo(){this.servicedelivery=0;this.serviceorigid=-1;this.serviceid=-1;this.serviceidsd=28106;this.sId=1;this.networkId=0;this.servicedebug="-";this.servicetype=-1;this.servicetsid=-1;this.servicename="";this.subtitdelay=0;this.appDsmccDisabled=false;this.checkChangedServiceTimer=null;this.ilsinfoElem=document.getElementById("ilsinfo");this.ilsinfoElem.appendChild(createClassDiv(false,false,"ilsinfobg"));this.ilsinfoElem.appendChild(this.ilsinfotxtElem=createClassDiv(false,false,"ilsinfotxt"));this.ilsinfoElem.appendChild(this.ilsinfoerrElem=createClassDiv(false,false,"ilsinfoerr"));try{var a=document.getElementById("video");a.style.left="0px";a.style.top="0px";a.style.width="1280px";a.style.height="720px"}catch(b){}}MxpVideo.prototype=new MxpOverlay();MxpVideo.prototype.getNowUtcMillis=function(){var a=new Date();return a.getTime()+GLOBALS.time.timediffUTC};MxpVideo.prototype.getUserAgentString=function(){return GLOBALS.stats.uagent.toUpperCase()};MxpVideo.prototype.initVideo=function(){var c=this,b=false,a=document.getElementById("video");try{a.setFullScreen(true)}catch(d){}try{a.bindToCurrentChannel()}catch(d){}try{a.onChannelChangeSucceeded=function(){GLOBALS.params.showtest=GLOBALS.showtest||false;c.checkChangedServiceId(2000);GLOBALS.settingspane.checkAudioLanguages(true);b=true}}catch(d){}try{a.onPlayStateChange=function(e){if(e!==1){return}a.onPlayStateChange=null;c.checkChangedServiceId(2000)}}catch(d){}if(!this.checkChangedServiceId(2000)){this.applyServiceId()}setTimeout(function(){if(!b){GLOBALS.settingspane.checkAudioLanguages(true);b=true}},2000)};MxpVideo.prototype.getServiceId=function(){var o=-1,l=0,f=true,h=false,g,c,b;if(this.servicedelivery>=0){this.serviceorigid=-1}try{var k,d,a=document.getElementById("video").currentChannel;if(!a){try{var m=document.getElementById("appmgr");if(m){a=m.getOwnerApplication(document).privateData.currentChannel}}catch(j){}}if(GLOBALS.overridechannel){a=GLOBALS.overridechannel}if(GLOBALS.brandinfo){a=a?{"onid":a.onid,"tsid":a.tsid,"sid":a.sid,"channelType":a.channelType,"idType":a.idType,"name":a.name}:{};for(k in GLOBALS.brandinfo){if(GLOBALS.brandinfo.hasOwnProperty(k)){a[k]=GLOBALS.brandinfo[k]}}}if((!a||!a.sid)&&this.servicedelivery<0){return this.serviceid}g=parseInt(a.onid,10);c=parseInt(a.tsid,10);b=parseInt(a.sid,10);if(!this.networkId){this.networkId=parseInt(a.nid||"0",10)||0}this.serviceorigid=isNaN(b)?-1:b;this.servicedebug=g+"."+c+"."+b;this.servicetype=a.channelType===1?-2:-1;this.servicedelivery=0;if(a.idType&&((a.idType>=10&&a.idType<=12)||(a.idType>=14&&a.idType<=16))){this.servicedelivery=a.idType;h=true}if(g>0&&c>0){this.servicetsid=c;if(svcregions[this.servicedebug]){b=svcregions[this.servicedebug][0];if(!h||svcregions[this.servicedebug][1]<0){this.servicedelivery=svcregions[this.servicedebug][1];h=true}l=svcregions[this.servicedebug][2]}}if(b&&((b>10000&&b<30000)||(b>=65000&&b<65535))&&svcinfo[toStr(b)]){o=b}else{if(svcregions["41985."+c+"."+b]){o=svcregions["41985."+c+"."+b][0]}else{if(!h){this.servicedelivery=10}this.servicename=GLOBALS.config.fixDvbEncoding(toStr(a.name));if(o===-1&&this.servicename){for(k in svcinfo){if(!svcinfo.hasOwnProperty(k)){continue}d=svcinfo[k];if(this.servicename.indexOf(d.name)>=0||(d.xname&&this.servicename.indexOf(d.xname)>=0)){o=parseInt(k,10);break}}}}}if(vidstreaming.forceEnabled){this.servicedelivery=-1}this.appDsmccDisabled=false;if(o>0&&svcinfo[toStr(o)]&&GLOBALS.nidreg&&svcregions["N_"+GLOBALS.nidreg]){f=!(svcinfo[toStr(o)].dvbsid);l=Math.max(0,l+svcregions["N_"+GLOBALS.nidreg][f?0:1]);this.appDsmccDisabled=svcregions["N_"+GLOBALS.nidreg][2];this.servicedelivery=10}this.subtitdelay=l||0;GLOBALS.subtitles.setDelay(l)}catch(n){o=-2}if(this.serviceorigid===-1){this.serviceorigid=this.serviceid}return o};MxpVideo.prototype.updateServiceId=function(){var a=false,b=this.servicedelivery,c;c=this.getServiceId();if(c===-2){return false}a=c!==this.serviceid||b!==this.servicedelivery;if(a){this.serviceid=c;this.applyServiceId()}return a};MxpVideo.prototype.checkChangedServiceId=function(b){var a,c=this;if(this.checkChangedServiceTimer){clearTimeout(this.checkChangedServiceTimer);this.checkChangedServiceTimer=null}a=this.updateServiceId();if(a){GLOBALS.config.loadConfig(true);b=300000}else{b=Math.max(2000,Math.min(300000,2*b))}if(vidstreaming.error){b=1000}this.checkChangedServiceTimer=setTimeout(function(){c.checkChangedServiceTimer=null;c.checkChangedServiceId(b)},b);return a};MxpVideo.prototype.applyServiceId=function(){var d=svcinfo[toStr(this.serviceid)];var c=null;var a=0;var b;this.serviceidsd=this.serviceid;if(d){this.sId=d.id||1;this.servicename=d.name;if(d.dvbsid){this.serviceidsd=d.dvbsid}if(d.ils&&this.servicedelivery<0){c={"sid":d.id,"istv":d.tv}}if(d.ovrly&&!GLOBALS.dsmccversion&&!GLOBALS.stats.cookies.info.nobg){a=d.id}}else{this.sId=0}this.showStreamingError(null,false);if(c&&GLOBALS.dsmccversion){c=null;this.showStreamingError("DSM",false)}b=this.radioimgElem;this.setOverlayId(a,d&&!d.tv&&!GLOBALS.stats.cookies.info.nobg&&this.serviceidsd?"img/bgimg/"+this.serviceidsd+".jpg":"");if(d&&((d.tv===0&&!GLOBALS.stats.cookies.info.nobg)||c)){if(d.tv===0&&GLOBALS.stats.cookies.info.nobg&&c){b.style.backgroundImage="none";b.className="fullscrn blackbg"}else{b.style.backgroundImage="url(img/bgimg/"+this.serviceidsd+".jpg)";b.className="fullscrn"}b.style.display="block"}else{b.style.display="none"}this.loadingElem.style.display=c?"block":"none";if(c){this.getStreamingData(c)}else{vidstreaming.streamInfo=null;vidstreaming.filter=null;vidstreaming.hasSubtitles=0;if(vidstreaming.elem){restartApp()}}this.applyBRM(d)};MxpVideo.prototype.applyBRM=function(f){var b,d,e,a,c=this;if(this.brm){try{this.brm.disable()}catch(g){}this.brm=null}if(!f||!this.serviceid||GLOBALS.dsmccversion){return}b=f.id;if(b!==106&&b!==13&&b!==14&&(b<73||b>78)&&!vidstreaming.streamInfo){return}try{e=this.servicedebug.split(".");d={"customerId":"urfcgnbx","networkId":this.networkId,"originalNetworkId":parseInt(e[0],10)||0,"transportStreamId":parseInt(e[1],10)||0,"serviceId":this.serviceorigid,"channelType":f.tv?2:1,"identificationType":this.servicedelivery,"channelKey":toStr(this.serviceidsd),"broadcastDelayInMillis":this.subtitdelay,"filterRate":-1,"disableSecureDataTransfer":true,"applicationTypeId":vidstreaming.streamInfo?1:0,"createSessionId":true};a=function(){try{c.brm=window.EinbliqIo.getSession(d);c.brm.start()}catch(h){}};if(window.EinbliqIo){a();return}if(!this.brmScriptAdded){this.brmScriptAdded=true;if(!MxpStats.loadScript("einbliq-brm.js")){return}}setTimeout(a,2000)}catch(g){}};MxpVideo.prototype.configureStreamingSubtitles=function(b){var c,d=0,a=vidstreaming.elem;if(a&&vidstreaming.hasSubtitles){try{c=a.getComponents(a.COMPONENT_TYPE_SUBTITLE);if(c&&c.length>0&&c[0]){d=2}if(d){if((GLOBALS.stats.cookies.info.subtitcfg&1)===1){a.selectComponent(c[0])}else{if(b){a.unselectComponent(c[0])}}}}catch(e){}}if((vidstreaming.configureSubtitles||b)&&vidstreaming.hasSubtitles){d=2}if(d===vidstreaming.hasSubtitles){return}if(vidstreaming.hasSubtitles!==d){vidstreaming.hasSubtitles=d;GLOBALS.config.loadConfig(true)}};MxpVideo.prototype.showStreamingError=function(b,a){var c;this.ilsinfoElem.style.display=b?"block":"none";this.ilsinfoElem.className="ilsinfo"+(b==="DSM"?" dsmcc":"");this.ilsinfoerrElem.style.display=b?"block":"none";if(b){if(b==="R3"){c="Der Stream kann nicht wiedergegeben werden, da Ihr Ger&#x00E4;t nicht kompatibel ist. Das HbbTV-Angebot steht Ihnen jedoch &#x00FC;ber die rote Taste zur Verf&#x00FC;gung.<br/>"}else{if(b==="DSM"){c="Ihr Empfangsger&#x00E4;t ist HbbTV-f&#x00E4;hig, aber es ist nicht mit dem Internet verbunden.<br/>Sie haben weiterf&#x00FC;hrende Fragen: "}else{c="Der Sender kann auf Ihrem Ger&#x00E4;t leider nicht angezeigt werden. Für einen erneuten Versuch wechseln Sie bitte den Sender und kehren zu diesem Sender zur&#x00FC;ck.<br/>"}}c+="Wir helfen Ihnen gerne per Email unter zuschauer@ard-digital.de oder per Telefon unter 0331&#160;585&#160;696&#160;06";this.ilsinfotxtElem.innerHTML=c;this.ilsinfoerrElem.innerHTML="Fehler: "+b;this.loadingElem.style.display="none";this.radioimgElem.style.display=GLOBALS.dsmccversion?"none":"block";if(a){this.stopStreaming(function(){})}}};MxpVideo.prototype.checkStreamingState=function(){var f=this;if(vidstreaming.timr){clearTimeout(vidstreaming.timr)}if(!vidstreaming.elem){return}if(this.checkChangedServiceId(2000)){return}var a;var e=vidstreaming.demo?1:(vidstreaming.elem.playState||0);var d=vidstreaming.loading||false;var c=vidstreaming.error||null;var b=1000;if(e===1){vidstreaming.stat=0;vidstreaming.loading=false;if(!vidstreaming.wasPlaying){this.configureStreamingSubtitles(false)}vidstreaming.wasPlaying=true;vidstreaming.playingSec++;if(vidstreaming.playingSec>900&&vidstreaming.retryCount){vidstreaming.retryCount=0}}else{if(e===5&&(vidstreaming.wasPlaying||vidstreaming.stat>10)){vidstreaming.error="E1"}else{if(e===6){vidstreaming.error="E2"}else{vidstreaming.loading=true;vidstreaming.stat+=(e===3||e===4)?1:6;if(vidstreaming.stat>40&&!vidstreaming.error){vidstreaming.error=vidstreaming.wasPlaying?"T2":"T1"}}}}if(e!==vidstreaming.lastState||(vidstreaming.error&&!c)){vidstreaming.lastState=e;try{if(vidstreaming.argos){if(e===1){a=3}else{if(e===2){a=4}else{if(e===3){a=0}else{if(e===4){a=1}else{if(e===5||e===6){a=10}else{a=-1}}}}}if(a>=0){vidstreaming.argos.addPlayState(a,vidstreaming.elem.playPosition?vidstreaming.elem.playPosition/1000:0)}if(vidstreaming.error){vidstreaming.argos.addError("Fehler "+vidstreaming.error+(vidstreaming.error==="E2"?":"+vidstreaming.elem.error:""),vidstreaming.retryCount<2?1:3);if(vidstreaming.retryCount>=2){vidstreaming.argos.terminate();vidstreaming.argos=null}}}}catch(g){}}if(vidstreaming.error){if(vidstreaming.retryCount<2){vidstreaming.retryCount++;vidstreaming.playingSec=0;vidstreaming.stat=1;vidstreaming.wasPlaying=false;vidstreaming.loading=true;vidstreaming.error=null;vidstreaming.lastState=null;try{vidstreaming.elem.stop()}catch(g){}setTimeout(function(){try{vidstreaming.elem.play(1)}catch(h){}},1000);b+=1000}else{vidstreaming.loading=false}}if(vidstreaming.loading!==d||vidstreaming.error!==c){this.radioimgElem.style.display=(vidstreaming.loading||vidstreaming.error||!vidstreaming.istv||(vidstreaming.streamInfo&&vidstreaming.streamInfo.istv===0&&GLOBALS.stats.cookies.info.nobg))?"block":"none";this.loadingElem.style.display=vidstreaming.loading?"block":"none";if(vidstreaming.error&&vidstreaming.streamInfo&&!vidstreaming.streamInfo.isBackup&&vidstreaming.streamInfo.backupUrl){vidstreaming.streamInfo.isBackup=true;vidstreaming.filter=null;vidstreaming.hasSubtitles=0;this.startStreaming(vidstreaming.streamInfo);return}this.showStreamingError(vidstreaming.error,false)}if(!vidstreaming.error){vidstreaming.timr=setTimeout(function(){vidstreaming.timr=null;f.checkStreamingState()},b)}};MxpVideo.prototype.isDeviceOnUamList=function(b,c){var d,f,e,g,a;if(vidstreaming.noBlacklist){d=vidstreaming.noBlacklist===-1;return c?!d:d}if(!b){return c||false}for(d=0;d<b.length;d++){try{e=b[d];g=e.substring(0,1)==="!";if(g){e=e.substring(1)}f=new RegExp(e,"i");a=f.test(GLOBALS.stats.uagent);if(g){a=!a}if(a){return !c}}catch(h){if(c){return false}}}return c||false};MxpVideo.prototype.buildFilter=function(e){var d,c,a=false,b={};vidstreaming.hasSubtitles=0;try{if(e===null){e=vidstreaming.streamInfo}if(!e||e.isBackup){return null}if(e.audioTracks&&e.audioTracks.length>1){b.atr=0;a=true;for(d=0;d<e.audioTracks.length;d++){if(e.audioTracks[d]===GLOBALS.stats.cookies.info.langcfg){b.atr=d}}}if(e.hasSubtit){c=this.getUserAgentString();if(!vidstreaming.configureSubtitles&&(c.indexOf("HBBTV/")<0||c.indexOf("HBBTV/0")>0||c.indexOf("HBBTV/1.0.")>0||c.indexOf("HBBTV/1.1.")>0||c.indexOf("HBBTV/1.2.")>0||c.indexOf("HBBTV/1.3.")>0)){b.striptt=1;a=true}else{vidstreaming.hasSubtitles=1}}}catch(f){}return a?b:null};MxpVideo.prototype.getStreamingData=function(b){var a=this;vidstreaming.streamInfo=b;vidstreaming.filter=null;vidstreaming.hasSubtitles=0;abortHttpRequest(vidstreaming.datareq);vidstreaming.datareq=null;try{vidstreaming.datareq=createHttpRequest("api/ils.php?sid="+b.sid,function(d){d=parseJSON(d);vidstreaming.datareq=null;if(!d||!d.mainUrl||!d.blacklist){a.showStreamingError("R2",true);return}b.mainUrl=(GLOBALS.anydev||a.isDeviceOnUamList(d.blacklist,true))?d.mainUrl:null;b.backupUrl=vidstreaming.nobackup?null:(d.backupUrl||null);b.isBackup=!b.mainUrl;b.audioTracks=d.audioTracks||[];b.hasSubtit=d.hasSubtit||false;b.name=d.name||"noname";vidstreaming.datareq=null;vidstreaming.filter=a.buildFilter(b);if(b.isBackup&&!b.backupUrl){a.showStreamingError("R3",true)}else{a.startStreaming(b)}})}catch(c){vidstreaming.datareq=null;this.showStreamingError("R1",true)}};MxpVideo.prototype.startStreaming=function(f){var e,l,a,b,k,h,d,j=this;vidstreaming.elem=document.getElementById("video");vidstreaming.istv=!(!f.istv);k=f.isBackup?f.backupUrl:f.mainUrl;k=k.split("#");if(!k[1]){b=k[0].substring(k[0].length-4);b=b.toLowerCase();k[1]=(vidstreaming.istv||b===".mpd")?"application/dash+xml":"audio/mpeg"}try{vidstreaming.elem.stop()}catch(g){}try{vidstreaming.elem.release()}catch(g){}h=k[0];if(vidstreaming.filter&&h){b="";for(e in vidstreaming.filter){if(vidstreaming.filter.hasOwnProperty(e)){b+=(b?";":"")+e+"-"+vidstreaming.filter[e]}}if(b){h="http://itv.ard.de/ardstart/dyn/stream.php/"+b+"/"+h.replace("://","/")}}a='<object id="video" type="'+k[1]+'" data="'+h+'" width="1280" height="720" style="position: absolute; left: 0px; top: 0px; width: 1280px; height: 720px; outline: transparent;"></object>';vidstreaming.elem=null;l=document.getElementById("videocontainer");l.innerHTML=a;if(!this.sessionId){try{d=""+(new Date()).getTime();while(d.length<32){d+=Math.floor(Math.random()*16).toString(16).toLowerCase()}this.sessionId=d.substring(0,8)+"-"+d.substring(8,12)+"-"+d.substring(12,16)+"-"+d.substring(16,20)+"-"+d.substring(20,32)}catch(c){}}setTimeout(function(){vidstreaming.elem=document.getElementById("video");vidstreaming.elem.data=h;try{if(vidstreaming.argos){vidstreaming.argos.terminate();vidstreaming.argos=null}}catch(i){}vidstreaming.stat=1;vidstreaming.retryCount=0;vidstreaming.playingSec=0;vidstreaming.wasPlaying=false;vidstreaming.loading=true;vidstreaming.error=null;vidstreaming.lastState=null;try{vidstreaming.elem.play(1)}catch(i){}j.checkStreamingState()},300)};MxpVideo.prototype.stopStreaming=function(b,a){var c,e;if(!vidstreaming.elem){b();return}try{vidstreaming.elem.stop()}catch(d){}try{vidstreaming.elem.data=null;vidstreaming.elem.release()}catch(d){}try{if(vidstreaming.argos){vidstreaming.argos.terminate();vidstreaming.argos=null}}catch(d){}vidstreaming.hasSubtitles=0;vidstreaming.elem=null;e='<object id="video" type="video/broadcast" width="1280" height="720" style="position: absolute; left: 0px; top: 0px; width: 1280px; height: 720px; outline: transparent;"></object>';c=document.getElementById("videocontainer");c.innerHTML=e;c=document.getElementById("video");if(!c){b();return}try{c.bindToCurrentChannel()}catch(d){}setTimeout(function(){if(a){try{c.unselectComponent(c.COMPONENT_TYPE_VIDEO)}catch(f){}try{c.unselectComponent(c.COMPONENT_TYPE_AUDIO)}catch(f){}}b()},1000)};function MxpTime(){this.timediffUTC=0;this.timediff=0;this.timr=null;this.timeElems=[];this.getTimeDiff()}MxpTime.prototype.getTimeDiff=function(){var a=this;try{createHttpRequest("api/now.php?t="+Math.floor((new Date()).getTime()/2000),function(f){var e,c=new Date();if(!f){return}f=f.split(",");if(f.length!==7){return}GLOBALS.stats.webavailable=true;for(e=0;e<f.length;e++){f[e]=parseInt(f[e],10);if(isNaN(f[e])||f[e]<0){return}}f[0]=f[0]*1000-c.getTime();a.timediffUTC=(f[0]>-30000&&f[0]<30000)?0:f[0];if(a.timediffUTC){c=new Date(c.getTime()+a.timediffUTC)}e=f[4]*3600+f[5]*60+f[6]-(c.getHours()*3600+c.getMinutes()*60+c.getSeconds());if(e<-43200){e+=86400}else{if(e>43200){e-=86400}}a.timediff=(e>-300&&e<300)?0:Math.round(e/60)*60000;a.updateTime()})}catch(b){}};MxpTime.prototype.updateNow=function(b){var a=new Date();b=1000+b*1000;this.timediffUTC=b-a.getTime()};MxpTime.prototype.getNow=function(){var a=new Date();if(this.timediffUTC||this.timediff){a=new Date(a.getTime()+this.timediffUTC+this.timediff)}return a};MxpTime.prototype.jsonToLocal=function(a){return new Date(a*1000+this.timediff)};MxpTime.prototype.formatTime=function(a){var b=a.getHours();var c=a.getMinutes();return(b<10?"0":"")+b+(c<10?":0":":")+c};MxpTime.prototype.updateTime=function(){var c,a,b=this.getNow(),d=this;a=this.formatTime(b);for(c=0;c<this.timeElems.length;c++){this.timeElems[c].updateTime(a)}var e=b.getSeconds();e=(61-e)*1000;if(this.timr){clearTimeout(this.timr)}this.timr=setTimeout(function(){d.timr=null;d.updateTime()},e)};MxpTime.prototype.addTimeElem=function(a){this.timeElems.push(a);this.updateTime()};function MxpConfig(){this.req=null;this.config=null;this.lastconfigload=0;this.timr=null;this.apiversion=2;this.debugtxt="-";this.epgapp={"id":"13.2"};this.subtitleapp={"id":"13.22"};this.streamingapp={"id":"13.3c"};this.replayapp={"id":"13.c0"};this.vtxapp={"id":"13.4","altname":"[VTX-App]"};this.teaser=null}MxpConfig.prototype.reloadConfigIfOld=function(){if(this.lastconfigload>0&&this.lastconfigload+60000<(new Date()).getTime()){this.loadConfig(false)}else{this.setConfigReload()}};MxpConfig.prototype.loadConfig=function(a){var b=this;abortHttpRequest(this.req);this.req=createHttpRequest("config.php",function(c){b.req=null;c=parseJSON(c);if(c){b.lastconfigload=(new Date()).getTime();b.parseConfig(c,a);GLOBALS.epgbar.update()}});this.setConfigReload()};MxpConfig.prototype.setConfigReload=function(){var b,c,a,f,d=60000,e=this;try{if(GLOBALS.dsmccversion){d=15000}else{if(!GLOBALS.focusmgr.hidden){d=60000}else{if(GLOBALS.stats.eitsupported){d=5400000}else{d=3600000;a=this.getEpgFromConfig();if(a.length>2){b=parseInt(a[2].substring(0,2),10)*60+parseInt(a[2].substring(3,5),10);if(!isNaN(b)){c=GLOBALS.time.getNow();c=c.getHours()*60+c.getMinutes();if(b<700&&c>800){b+=1440}c=b-c;if(c>-5){d=Math.min(d,Math.max(1,c)*60000)}}}}}}if(this.config&&GLOBALS.video.serviceid){f=this.config.nextChange[toStr(GLOBALS.video.sId)]||0;if(f>10&&f<4*3600){d=Math.min(d,f*1000)}}}catch(g){}if(this.timr){clearTimeout(this.timr)}this.timr=setTimeout(function(){e.timr=false;GLOBALS.video.updateServiceId();e.loadConfig(false)},d)};MxpConfig.prototype.parseConfig=function(v,l){var j=this.config===null;var u=GLOBALS.video.serviceid;var e=GLOBALS.video.serviceidsd;if((!v||v.apiver!==this.apiversion)||(!l&&!j&&v.version===this.config.version)){return}var p=GLOBALS.time.getNow();if(v.published&&this.config&&this.config.version&&v.version!==this.config.version&&!GLOBALS.dsmccversion&&v.published>p.getTime()/1000-1){GLOBALS.time.updateNow(v.published)}this.config=v;var s=v.widgets.svc[u]||null;if(!s){s=v.widgets.svc[e]||null}var r=[],c={},n=svcinfo[""+GLOBALS.video.serviceid];var t,f,g,b,k,o,q,m;var a,h=0;this.teaser=null;this.subtitleapp.cfg=this.epgapp.cfg=this.replayapp.cfg=this.vtxapp.cfg=null;for(p=0;s&&p<s.length;p++){t=s[p];f=v.widgets[toStr(t[0])];g=t[1];if((g&4)!==0&&(g&1)===0&&u!==e){g++}if(!f||((g&2)!==0&&GLOBALS.video.servicedelivery<0)||(!GLOBALS.params.showtest&&!GLOBALS.anydev&&f.uam&&!GLOBALS.video.isDeviceOnUamList(f.uam,f.uamIsBl||false))||(f.test&&!GLOBALS.params.showtest)){continue}b=toStr(f.appid||"");k=f.params||"";if(f.paramsbysid){if(f.paramsbysid.hasOwnProperty(toStr(u))){k=f.paramsbysid[toStr(u)]}else{if(f.paramsbysid.hasOwnProperty(toStr(e))){k=f.paramsbysid[toStr(e)]}}}o={"awid":t[0],"name":f.name,"appid":b,"params":k,"url":f.url,"flags":g,"icon":f.icon,"deep":f.deep||false};if(b===this.subtitleapp.id){if(GLOBALS.streamEventSupport>=0&&(!vidstreaming.streamInfo||vidstreaming.hasSubtitles>1)){this.subtitleapp.cfg=o}continue}q=null;if(b===this.epgapp.id){if(GLOBALS.brandinfo&&GLOBALS.brandinfo.noepg){continue}q=this.epgapp}else{if(b===this.replayapp.id){if(f.xtra){q=this.replayapp}}else{if(b===this.vtxapp.id||f.name===this.vtxapp.altname){q=this.vtxapp;if(f.name===this.vtxapp.altname){f.xtra=1}}else{if(b===this.subtitleapp.id){q=this.subtitleapp}}}}c[toStr(o.awid)]=o;c[b]=o;if(q&&(!GLOBALS.dsmccversion||this.isAppAvailable(o))){q.cfg=o}if(!q||!f.xtra){r.push(o)}}a=n&&!GLOBALS.dsmccversion&&v.teasers&&v.teasers.svc?v.teasers.svc[""+n.id]:null;for(p=0;a&&p<a.length;p++){t=a[p];q=t.reshow||null;t=v.teasers[""+t.tId];if(!t||(t.test&&!GLOBALS.params.showtest)){continue}t.reshow=q;if(t.wId){t.widget=c[toStr(t.wId)];if(!t.widget){continue}t.colid=2}this.teaser=t;break}if(this.subtitleapp.cfg){h=1}if(l){h=h>0&&GLOBALS.video.serviceorigid>0&&u>0&&!vidstreaming.streamInfo?GLOBALS.stats.cookies.info.subtitcfg||0:0;if((h&1)===0){h=0}this.debugtxt="subtitles:"+h+"/"+GLOBALS.stats.cookies.info.subtitcfg+":"+GLOBALS.video.sId+":"+GLOBALS.video.serviceidsd+":"+GLOBALS.video.serviceorigid+";"+GLOBALS.video.servicedebug+";"+GLOBALS.video.servicedelivery+(GLOBALS.dsmccversion?"D":"W")+"/"+GLOBALS.stats.cookies.info.cookies+":"+GLOBALS.stats.cookies.info.rangeid+":"+GLOBALS.stats.cookies.foundCookie+":"+GLOBALS.stats.cookies.info.rbp+"::"+GLOBALS.nidreg;if(j||h===0||(h&&!GLOBALS.subtitles.cfg.isenabled)){GLOBALS.subtitles.setConfig(h,h?(e||u):-1)}}if(GLOBALS.hidemsg.update(this.teaser,this.replayapp.cfg)){l=true}if(r.length===0&&!s){r.push({"awid":0,"name":"Unbekannter Sender","flags":0})}if(l||j){if(j){GLOBALS.hidemgr.setHidden(!GLOBALS.autoshow);showApplication();if(GLOBALS.autoshow){GLOBALS.widgetbar.sendShowCpix()}}else{if(GLOBALS.focusmgr.hidden){GLOBALS.hidemgr.setHidden(true)}}}this.setConfigReload();m=this.config.emgcy?this.config.emgcy[toStr(GLOBALS.video.sId)]:null;m=m?this.config.emgcy[toStr(m)]:null;if(m&&m.appid){m.app=c[toStr(m.appid)]||null}else{if(!m&&GLOBALS.forceemergency){m={"text":GLOBALS.forceemergency}}}GLOBALS.widgetbar.setWidgets(r,{"resetFocus":j,"emgcy":m||{}})};MxpConfig.prototype.loadPrivacyText=function(d,c,a){var b=this;if(this.privacytext){a(this.privacytext[d]);return}a("<h1>"+c+"</h1><br/><br/>Bitte warten, lade Text...");createHttpRequest("text.php",function(e){e=parseJSON(e);if(e){a(e[d]);b.privacytext=e}})};MxpConfig.prototype.getEpgFromConfig=function(){var a=null;if(this.config){a=this.config.epg[toStr(GLOBALS.video.sId)]}return a||null};MxpConfig.prototype.isAppAvailable=function(a){if(!a){return false}if(GLOBALS.stats.webavailable||this.subtitleapp.id===a.appid){return true}if(!(a.flags&1)||(GLOBALS.video.appDsmccDisabled&&this.vtxapp.id!==a.appid)){return false}return true};MxpConfig.prototype.runApp=function(b,d){var a,f=this;if(!this.isAppAvailable(b)){return false}var e=b.appid;if(!e||GLOBALS.stats.logstatreq){return true}var h=b.params||"";var c=b.url||"";if(e===this.replayapp.id){a=c+"&"+h;a=a.replace("?","&");h+=(h?"&":"?")+(GLOBALS.stats.cookies.info.rbp?"":"norbp")+"cpix="+GLOBALS.stats.cookies.info.cookies;if(a.indexOf("&sid=")<0){h+="&sid="+GLOBALS.video.sId}}if(d.addUrlParams){h+=(h&&h.indexOf("?")>=0?"&":"?")+d.addUrlParams}if(d.addParams){h+=(h&&h.indexOf("#")>=0?",":"#")+d.addParams}var g=function(){if(c&&d&&d.startByUrl){e=""}try{if(f.appstarttimer){return}if(GLOBALS.stats.uagent.toUpperCase().indexOf("SONY")>0){f.appstarttimer=setTimeout(function(){f.runAppInternal(e,c,h)},1000);return}}catch(i){}f.runAppInternal(e,c,h)};GLOBALS.subtitles.unregister();GLOBALS.video.stopStreaming(function(){var i,j,k;try{document.getElementById("video").setFullScreen(false)}catch(l){}if(b.awid){k=svcinfo[""+GLOBALS.video.serviceid];j=encodeURIComponent(GLOBALS.video.serviceidsd+"."+(k?k.name:"ARD"))+"::"+encodeURIComponent(e+"."+b.name);i=b.awid;if(d.teasercolkey>0){j+="::"+encodeURIComponent(d.teasertext||"Teaser");i=d.teasercolkey===3?0:(i+(d.teasercolkey*10000))}else{if(d.deeplink){j+="::"+encodeURIComponent(d.deeplink.length>30?d.deeplink.substring(0,27)+"...":d.deeplink)}else{if(d.barbutton){j+="::Button"}}}j+="::";if(h){j+=encodeURIComponent(h)}if(!GLOBALS.stats.cookies.info.rbp){g()}else{GLOBALS.stats.loadIVW(j,d.teasercolkey>0?"action":"navigation");setTimeout(function(){GLOBALS.stats.logstat(i,d.teasercolkey===3?2:1,g)},100)}}else{g()}},true);return true};MxpConfig.prototype.runAppInternal=function(l,b,a){var j,i,f,k=l.indexOf(","),d=GLOBALS.stats.appbase;if(k>0){l=l.substring(0,k)}try{if(GLOBALS.video&&GLOBALS.video.brm){GLOBALS.video.brm.onOpenNewApplication(b,l)}}catch(h){}j="dvb://current.ait/"+l;if(a){i=a.substring(0,1);if(i!=="?"&&i!=="#"){a="?"+a}j+=a}if(l===this.streamingapp.id){if(!a){a=""}if(j.indexOf("brm=")<0){i=GLOBALS.video.servicedebug.split(".");f=svcinfo[toStr(GLOBALS.video.serviceid)];if(f){a+=(a.indexOf("?")>=0?"&":"?")+"brm="+encodeURIComponent(i[0]+"."+i[1]+"."+GLOBALS.video.serviceorigid+"."+(f.tv?2:1)+"."+GLOBALS.video.serviceidsd+"."+f.id)}}if(j.indexOf("brmdelay=")<0){a+=(a.indexOf("?")>=0?"&":"?")+"brmdelay="+(GLOBALS.video.subtitdelay||0)}}else{if(l===this.subtitleapp.id){if(b&&b.substring(0,d.length)===d){b=b.substring(d.length);if(GLOBALS.dsmccversion&&b.substring(b.length-4)===".php"){b=b.substring(0,b.length-4)+".html"}}if(!a){a=""}if(a.indexOf("sid=")<0&&svcinfo[""+GLOBALS.video.serviceid]){a+=(a.indexOf("#")>=0?",":"#")+"sid="+svcinfo[""+GLOBALS.video.serviceid].id}if(vidstreaming.streamInfo){a+=(a.indexOf("#")>=0?",":"#")+"ils=1"}}else{if(l===this.replayapp.id&&b&&b.substring(0,d.length)===d){b=b.substring(d.length)}else{if(l){try{var m=document.getElementById("appmgr");var c=m.getOwnerApplication(document);if(c.createApplication(j,false)){c.destroyApplication();return}}catch(g){}}}}}if(!b){return}if(a){i=a.substring(0,1);if(i==="?"&&b.indexOf("?")>0){a="&"+a.substring(1)}else{if(i==="#"&&b.indexOf("#")>0){b=b.substring(0,b.indexOf("#"))}}b+=a}document.location.href=b};MxpConfig.prototype.fixDvbEncoding=function(a){var b="",c,d;if(a.length===0){return a}for(c=0;c<a.length;c++){d=a.charCodeAt(c);if(d===212){b+="\u00e4"}else{if(d===246){b+="\u00f6"}else{if(d===252){b+="\u00fc"}else{if(d===223){b+="\u00df"}else{if(d>=32){b+=a.charAt(c)}}}}}}try{a=a.replace(/ä/g,"\u00e4");a=a.replace(/ö/g,"\u00f6");a=a.replace(/ü/g,"\u00fc");a=a.replace(/ß/g,"\u00df");a=a.replace(/Ä/g,"\u00c4");a=a.replace(/Ö/g,"\u00d6");a=a.replace(/Ü/g,"\u00dc")}catch(e){}return a};MxpConfig.prototype.loadEitData=function(){var j,o,p,l,d,k,b,c,f,a,g=[false,false,false];try{c=GLOBALS.stats.uagent.toUpperCase();if(c.indexOf("SMARTTV2013")>0||c.indexOf("SMARTTV2012")>0||c.indexOf("MAPLE")>0){return null}b=document.getElementById("video").programmes;a=GLOBALS.time.getNow().getTime()/1000;f=Math.round(GLOBALS.time.timediff/3600000)*3600;for(j=0;j<2;j++){if(b[j]){o=b[j];if(!o.name||o.name==="No information"||o.name==="Blocked"||o.startTime<50000000){continue}if(j===0&&(f+(o.startTime+o.duration)+3600<a||f+o.startTime-900>a)){continue}p=new Date((f+o.startTime)*1000);l=parseInt(p.getHours(),10);d=parseInt(p.getMinutes(),10);l=(l<10?"0":"")+l+(d<10?":0":":")+d;k=this.fixDvbEncoding(o.name);if(k.length>3){g[j*2]=l;g[j*2+1]=k}}}}catch(n){}GLOBALS.stats.eitsupported=g[0]&&g[1]&&g[2];return GLOBALS.stats.eitsupported?g:null};function MxpHideMsg(){var a;this.teasercfg=null;this.cfgtxt=null;this.blueButtonElem=document.createElement("div");this.blueButtonElem.appendChild(a=createClassDiv(false,false,"colbutton"));a.innerHTML="Sendung neu starten";a.appendChild(createClassDiv(false,false,"btn b"));this.redButtonElem=a=createClassDiv(false,false,"colbutton posr");a.innerHTML="Startleiste";a.appendChild(createClassDiv(false,false,"btn r"));this.privTextElem=a=document.createElement("p");a.className="hmprivacy";a.innerHTML="Datenschutzhinweise";this.teaserElem=document.createElement("div");this.elem=a=document.getElementById("hidemsg");this.update(null,false);this.reshowTimer=null;a.appendChild(this.teaserElem);a.appendChild(this.blueButtonElem)}MxpHideMsg.prototype.update=function(a,b){var c;c=(a?"#"+a.dt+"#"+a.pos+"#"+(a.cat||"")+"#"+(a.tit||"")+"#"+(a.st||"")+"#"+(a.img||"")+"#"+(a.colid||"0"):"")+"*"+(b?1:0);this.teasercfg=a;if(c===this.cfgtxt){return false}this.cfgtxt=c;this.blueButtonElem.style.display=b?"block":"none";this.teaserElem.innerHTML="";if(a&&a.dt){this.renderTeaser(a);if(GLOBALS&&GLOBALS.focusmgr&&GLOBALS.hidemgr&&GLOBALS.focusmgr.hidden&&!GLOBALS.hidemgr.hidemsgtimer){GLOBALS.hidemgr.setHidden(true)}}else{this.teaserElem.className="hmteaser empty right";this.blueButtonElem.className="hmteaser bluebtn left";this.teaserElem.appendChild(this.redButtonElem);this.teaserElem.appendChild(this.privTextElem)}this.updateColorKeys(b)};MxpHideMsg.prototype.updateColorKeys=function(b){var a,c=(this.teasercfg?(this.teasercfg.colid||0):0)+(b?10:0);if(c!==this.specialColorKeyEnabled){this.specialColorKeyEnabled=c;for(a=0;a<3;a++){GLOBALS.focusmgr.hiddenColorKeys[a]=a+1===(c%10)}if(b){GLOBALS.focusmgr.hiddenColorKeys[2]=true}if(GLOBALS.config.config){GLOBALS.focusmgr.reconfigKeyset()}}this.handleReshow()};MxpHideMsg.prototype.handleReshow=function(){var c,f,b,a=0,e=this;if(this.reshowTimer){clearTimeout();this.reshowTimer=null}if(!this.teasercfg||!this.teasercfg.reshow||!this.teasercfg.reshow.length){return}b=new Date();b=b.getTime()+GLOBALS.time.timediffUTC;for(c=0;c<this.teasercfg.reshow.length;c++){f=this.teasercfg.reshow[c]*1000-b;if(f>=0){a=55000;if(f>5500){a=f-(f>10500?10000:5000)}else{if(GLOBALS.focusmgr.hidden){GLOBALS.hidemgr.setHidden(true)}}break}}if(a>0){this.reshowTimer=setTimeout(function(){e.reshowTimer=null;e.handleReshow()},a)}};MxpHideMsg.prototype.renderTeaser=function(c){var j,i,d,g,b,f,k,a=this.teaserElem;f="hmteaser dt"+c.dt+(c.pos===2?" left":" right");k="hmteaser bluebtn "+(c.pos===2?"right":"left");g=d=b=null;if(c.img){if(!c.cat){f+=" nocatimg"}g=document.createElement("img");g.className=c.dt===4||c.dt===5||c.dt===8?"absimg":"flowimg";g.src=c.img;if(c.dt===8){a.appendChild(g);a.appendChild(createClassDiv(false,false,"hmshade"))}}if(c.colid){d=createClassDiv(false,false,"colbutton posx");if(c.wId===1568||c.wId===1591||(c.widget&&c.widget.appid==="13.e4")){d.innerHTML="Jetzt anh\u00f6ren"}else{d.innerHTML="Jetzt ansehen"}d.appendChild(createClassDiv(false,false,"btn "+(c.colid===1?"g":"y")))}if(c.cat){j=document.createElement("p");j.className="hmcategory";j.innerHTML=textHtmlEncode(c.cat);a.appendChild(j)}if(g&&c.dt!==4&&c.dt!==8){a.appendChild(g)}if(c.dt!==8){this.buildTeaserTitle(c,a)}if(c.dt===5){f="hmteaser dt"+c.dt;k="hmteaser bluebtntop"}if(c.dt>=5&&c.dt<9){b=createClassDiv(false,false,"hmbuttonbar"+(d?"":" nobtny"));a.appendChild(b);if(c.dt===8){this.buildTeaserTitle(c,b);this.buildSpacer(b)}}if(b){if(d){b.appendChild(d)}b.appendChild(this.redButtonElem);b.appendChild(this.privTextElem)}else{this.buildSpacer(a);if(d){a.appendChild(d)}a.appendChild(this.redButtonElem);a.appendChild(this.privTextElem)}a.className=f;this.blueButtonElem.className=k;if(c.img&&c.dt===4){i=parseInt(this.teaserElem.offsetHeight,10)||120;g.style.height=i+"px";i=Math.round(16*i/9);g.style.width=i+"px";g.style.left="-"+i+"px";g.style.top="0px";a.appendChild(g)}};MxpHideMsg.prototype.buildSpacer=function(a){var b=createClassDiv(false,false,"spacer");b.innerHTML="&#160;";a.appendChild(b)};MxpHideMsg.prototype.buildTeaserTitle=function(b,a){var c;if(b.tit){c=document.createElement("p");c.className="hmtitle";c.innerHTML=textHtmlEncode(b.tit);a.appendChild(c)}if(b.st){c=document.createElement("p");c.className="hmsubtitle";c.innerHTML=textHtmlEncode(b.st);a.appendChild(c)}};MxpHideMsg.prototype.runReplayApp=function(){var a=GLOBALS.config.replayapp.cfg;if(!a){return false}GLOBALS.config.runApp(a,{"teasercolkey":3,"teasertext":"Replay","addParams":"fromblue=1"});return true};MxpHideMsg.prototype.runTeaserApp=function(){var d,b,a,c;if(!this.teasercfg){return false}c=this.teasercfg.cpix||"";if(!c){c=this.teasercfg.tit||"";if(!c){c=this.teasercfg.cat||""}}d={"teasercolkey":this.teasercfg.colid,"teasertext":c};a=this.teasercfg.params;if(a){b=a.substring(0,1)==="#"?"addParams":"addUrlParams";if(b==="addParams"||a.substring(0,1)==="?"){a=a.substring(1)}if(a){d[b]=a}}GLOBALS.config.runApp(this.teasercfg.widget,d);return true};MxpHideMsg.prototype.runColorApp=function(a){if(this.teasercfg&&a===this.teasercfg.colid){return this.runTeaserApp()}if(a===3){return this.runReplayApp()}return false};function MxpEpgBar(a){this.idnam=a}MxpEpgBar.prototype=new MxpBaseObject();MxpEpgBar.prototype.init=function(c){var b,g,a,f=createClassDiv(false,false,"epgbar");f.appendChild(this.bgElem=createClassDiv(false,false,"barbg"));f.appendChild(this.svclogoElem=createClassDiv(false,false,"svclogo"));f.appendChild(this.svcnameElem=createClassDiv(false,false,"svcname"));f.appendChild(this.timeElem=createClassDiv(false,false,"currtime"));this.events=[];for(b=0;b<2;b++){g={"cn":"event "+(b?"following":"present")};g.elem=createClassDiv(false,false,g.cn);g.elem.appendChild(createClassDiv(false,false,"bg"));g.elem.appendChild(g.title=createClassDiv(false,false,"telem title"));g.elem.appendChild(g.attr=createClassDiv(false,false,"telem attrib"));if(b===0){g.elem.appendChild(a=createClassDiv(false,false,"progress"));a.appendChild(g.prog=createClassDiv(false,false,"fg"))}f.appendChild(g.elem);this.events.push(g)}c.appendChild(f);this.baseInit(f);this.svcid=0;this.svctxt="";this.titleText="";this.progressWidth=860;GLOBALS.time.addTimeElem(this);this.focused=false;this.setFocusIdx(0)};MxpEpgBar.prototype.updateTime=function(a){this.timeElem.innerHTML=a;this.update()};MxpEpgBar.prototype.setFocused=function(a,b){this.focused=b;this.setFocusIdx(this.focusIdx)};MxpEpgBar.prototype.setFocusIdx=function(a){var b;this.focusIdx=Math.max(0,Math.min(this.events.length-1,a));for(a=0;a<this.events.length;a++){b=this.events[a];b.elem.className=b.cn+(a===this.focusIdx&&this.focused?" focus":"")}};MxpEpgBar.prototype.openDetail=function(){var a=this.events[this.focusIdx];if(!a||!a.eventId||GLOBALS.dsmccversion){return}GLOBALS.epgdetail.open(a.titleTxt,this.focusIdx===0,a.eventId);GLOBALS.stats.loadIVW("Programm::"+(this.focusIdx?"Next":"Now")+"::"+toStr(GLOBALS.video.serviceidsd))};MxpEpgBar.prototype.update=function(){var e,n,j,o,k,a,f,g,b,c,p;o=svcinfo[""+GLOBALS.video.serviceid];if(!o){k=GLOBALS.video.servicename||"ARD"}else{if(!o.ico||GLOBALS.dsmccversion||GLOBALS.stats.isForAll()){k=o.name||"ARD"}else{k=null;if(this.svcid!=o.id){this.svclogoElem.style.backgroundImage=buildCssUrl("img/services/"+o.ico);this.svcid=o.id}}}this.elem.className="epgbar"+(o&&o.tv===0?" radio":"");this.svcnameElem.style.display=k?"block":"none";this.svclogoElem.style.display=k?"none":"block";if(this.svctxt!==k){this.svcnameElem.innerHTML=textHtmlEncode(k);this.svctxt=k;this.svcnameElem.className="svcname"+(this.svcnameElem.offsetHeight>40?" twoline":"")}j=[];f=GLOBALS.config.getEpgFromConfig();if(f&&f.length){for(e=0;e<f.length;e++){j.push(f[e])}}f=GLOBALS.config.loadEitData();if(f&&f.length){for(e=0;e<f.length&&e<4;e++){if(f[e]){j[e]=f[e]}}}if(!j||j.length<3){j=["00:00","Keine Daten vorhanden","24:00"]}f=j[0]+"-"+j[1]+"-"+j[2]+"-"+j[3]+"-"+j[4]+"-"+j[5];if(f!==this.titleText){this.titleText=f;g=j.length>6?parseInt(j[6],10):0;if(isNaN(g)){g=0}for(e=0;e<this.events.length;e++){try{n=this.events[e];n.titleTxt=j[1+(e*2)]||"";n.flags=(g>>(e*4))&15;n.eventId=j[4+e];n.title.innerHTML=textHtmlEncode(j[e*2])+"&#160;&#160;"+textHtmlEncode(shortenText(n.titleTxt,GLOBALS.stats.isLargeFont()?24:29));n.attr.innerHTML=(n.flags&1)>0?"UT":""}catch(l){}}}g=parseInt(j[0].substring(0,2),10);b=parseInt(j[0].substring(3,5),10);c=g*60+b;g=parseInt(j[2].substring(0,2),10);b=parseInt(j[2].substring(3,5),10);p=g*60+b;p=Math.max(c+1,p+(p<c?1440:0));a=GLOBALS.time.getNow();b=a.getHours()*60+a.getMinutes();g=Math.max(0,Math.min(100,Math.round((100*(b-c))/(p-c))));n=this.events[0];n.prog.style.width=g+"%"};MxpEpgBar.prototype.handleKeyPress=function(a){if(a===VK_LEFT||a===VK_RIGHT){this.setFocusIdx(this.focusIdx+(a===VK_LEFT?-1:1));return true}if(a===VK_DOWN){GLOBALS.widgetbar.requestFocus();return true}if(a===VK_UP){return true}if(a===VK_ENTER){this.openDetail();return true}return false};function MxpEpgDetail(a){this.idnam=a}MxpEpgDetail.prototype=new MxpBaseObject();MxpEpgDetail.prototype.init=function(b){var a,f,c=createClassDiv(false,false,"epgdetail fullscrn");c.appendChild(createClassDiv(false,false,"fullscrn shadebg"));c.appendChild(this.svclogoElem=createClassDiv(false,false,"svclogo"));c.appendChild(this.timeElem=createClassDiv(false,false,"currtime"));c.appendChild(this.buttonrowElem=createClassDiv(false,false,"buttonrow"));c.appendChild(this.textElem=createClassDiv(false,false,"eventtext"));c.appendChild(this.infotextElem=createClassDiv(false,false,"eventinfo"));c.appendChild(this.imgElem=document.createElement("img"));c.appendChild(this.progbarShadeElem=createClassDiv(false,false,"progbarshade"));c.appendChild(this.progbarElem=createClassDiv(false,false,"progbar"));this.imgElem.className="eventimg";this.progbarElem.appendChild(createClassDiv(false,false,"bg"));this.progbarElem.appendChild(this.progElem=createClassDiv(false,false,"fg"));c.appendChild(this.tippElem=createClassDiv(false,false,"tipp"));this.buttons=[{"id":"back","name":"Zur\u00fcck","icon":"back"},{"id":"epg","name":"TV Programm"}];for(a=0;a<this.buttons.length;a++){f=this.buttons[a];f.cn="button"+(f.icon?" withicon":"");f.elem=createClassDiv(false,false,f.cn);f.elem.innerHTML=f.name;if(f.icon){f.elem.appendChild(createClassDiv(false,false,"icon "+f.icon))}this.buttonrowElem.appendChild(f.elem)}b.appendChild(c);this.baseInit(c);GLOBALS.time.addTimeElem(this);this.epgbtn=this.buttons[1];this.req=null;this.setFocused(null,false)};MxpEpgDetail.prototype.updateTime=function(a){this.timeElem.innerHTML=a};MxpEpgDetail.prototype.open=function(e,a,b){var d=svcinfo[""+GLOBALS.video.serviceid],c=this;this.epgenabled=GLOBALS.config.epgapp.cfg;this.epgbtn.elem.style.opacity=this.epgenabled?"1":"0";this.oldFocus=GLOBALS.focusmgr.currentFocus||null;this.svclogoElem.style.backgroundImage=d?buildCssUrl("img/services/"+d.ico):"none";this.svcname=d?d.name:"ARD";this.textElem.innerHTML='<p class="title">'+textHtmlEncode(e)+'</p><p class="subtitle">Bitte warten...</p>';this.infotextElem.innerHTML="";this.progbarElem.style.display="none";this.imgElem.style.display="none";this.tippElem.style.display="none";this.requestFocus();if(this.req){abortHttpRequest(this.req)}this.req=createHttpRequest("../ardepg/dyn/detail.php?id="+encodeURIComponent(b),function(f){c.req=null;f=parseJSON(f);if(f){c.setData(f,a)}})};MxpEpgDetail.prototype.setData=function(f,c){var b,a=null,e=svcinfo[""+GLOBALS.video.serviceid];this.textElem.innerHTML='<p class="title">'+textHtmlEncode(f.title||"")+'</p><p class="subtitle">'+textHtmlEncode(f.subtitle||"")+"</p>"+(f.detail||"");if(f.img){a="evtimg.php?id="+encodeURIComponent(f.img)+"&type=1"}else{if(e&&e.id){a="svcimg.php?id="+e.id+"&type=0"}}this.imgElem.style.display=a?"block":"none";if(a){this.imgElem.src="../ardepg/img/"+a}if(f.istipp){this.tippElem.style.display="block"}this.infotextElem.innerHTML=(c?"Jetzt":"Danach")+"<br/>"+this.formatTime(f.start)+" - "+this.formatTime(f.end)+" | "+Math.round((f.end-f.start)/60)+" Min,<br/>"+textHtmlEncode(this.svcname)+"<br/><br/>"+(f.issubtitle?"UT":"");this.progbarShadeElem.style.display=a&&c?"block":"none";if(c){this.progbarElem.style.display="block";b=GLOBALS.time.getNow();b=b.getTime()/1000;b=(b-f.start)/Math.max(1,f.end-f.start);this.progElem.style.width=Math.max(0,Math.min(100,Math.round(100*b)))+"%"}};MxpEpgDetail.prototype.formatTime=function(a){a=GLOBALS.time.jsonToLocal(a);return GLOBALS.time.formatTime(a)};MxpEpgDetail.prototype.setFocused=function(a,b){this.elem.style.display=b?"block":"none";this.setFocusIdx(0)};MxpEpgDetail.prototype.setFocusIdx=function(a){var b;this.focusIdx=Math.max(0,Math.min(this.buttons.length-1,a));if(!this.epgenabled){this.focusIdx=0}for(a=0;a<this.buttons.length;a++){b=this.buttons[a];b.elem.className=b.cn+(a===this.focusIdx?" focus":"")}};MxpEpgDetail.prototype.goBack=function(){if(this.oldFocus){this.oldFocus.requestFocus();GLOBALS.widgetbar.sendShowCpix()}};MxpEpgDetail.prototype.runEpg=function(){var a=GLOBALS.config.epgapp.cfg;if(a){GLOBALS.config.runApp(a,{})}};MxpEpgDetail.prototype.handleKeyPress=function(a){if(a===VK_UP||a===VK_DOWN){return true}if(a===VK_LEFT||a===VK_RIGHT){this.setFocusIdx(this.focusIdx+(a===VK_LEFT?-1:1));return true}if(a===VK_BACK){this.goBack();return true}if(a===VK_ENTER){if(this.focusIdx){this.runEpg()}else{this.goBack()}return true}return false};function MxpEmgcyInfo(){}MxpEmgcyInfo.prototype=new MxpBaseObject();MxpEmgcyInfo.prototype.init=function(a){this.elem=createClassDiv(false,false,"");this.setHidden(true);this.data={};a.appendChild(this.elem)};MxpEmgcyInfo.prototype.updateCn=function(){this.elem.className="emgcy"+(this.focused?" focus":"");this.elem.style.display=(this.focused||!this.isHidden)?"block":"none"};MxpEmgcyInfo.prototype.setHidden=function(a){if(this.isHidden===a){return}this.isHidden=a;this.updateCn()};MxpEmgcyInfo.prototype.setFocused=function(a,b){this.focused=b;this.updateCn()};MxpEmgcyInfo.prototype.setData=function(b){var c,a;this.setHidden(!b||!b.text);if(this.isHidden){this.isFocusable=false;this.data={};if(this.focused){GLOBALS.widgetbar.handleKeyPress(VK_DOWN)}return}if(b.text!==this.lastText){this.lastText=b.text;this.elem.innerHTML="";this.elem.appendChild(createClassDiv(false,false,"bg"));this.elem.appendChild(createClassDiv(false,false,"icon warn"));this.elem.appendChild(c=createClassDiv(false,false,"text"));this.elem.style.width="1200px";this.elem.style.height="70px";c.innerHTML=textHtmlEncode(b.text,false);a=parseInt(c.offsetWidth,10);a=Math.min(1100,a<10?1200:a+2);c.style.width=a+"px";this.elem.style.width=(a+70)+"px";a=parseInt(c.offsetHeight,10);if(a>32){this.elem.style.height=a>67?"115px":"90px"}}this.data=b;this.isFocusable=b.app?GLOBALS.config.isAppAvailable(b.app):false};MxpEmgcyInfo.prototype.openApp=function(){var c,e,a,b=this.data.app,g={},d={};if(!b||!this.isFocusable){return}a=["appid","awid","flags","name","url"];for(c=0;c<a.length;c++){e=a[c];g[e]=b[e]||null}MxpCoverItemList.prototype.applyAppLink.call(this,this.data,d);GLOBALS.config.runApp(g,d)};function MxpCoverItemList(){}MxpCoverItemList.prototype=new MxpBaseObject();MxpCoverItemList.prototype.init=function(a){this.outerCn="itemlist animopac";this.elem=createClassDiv(false,false,"");this.setHidden(true);this.data=[];this.selxpos=64;this.preferredfocusoffset=100;this.pageEnd=1200;this.coveritemwidth=358;this.coverbanditemoffset=50;this.coverband=createClassDiv(this.selxpos-this.coverbanditemoffset,false,"coverband animx");this.elem.appendChild(createClassDiv(false,false,"itemlistbg"));this.elem.appendChild(this.coverband);this.focusIdx=0;this.coverbandScrollX=0;this.resetView();a.appendChild(this.elem)};MxpCoverItemList.prototype.setHidden=function(a){if(this.isHidden===a){return}this.isHidden=a;this.elem.className=this.outerCn+(a?" hidden":"")};MxpCoverItemList.prototype.setFocused=function(a,b){this.focused=b;this.updateElement(this.focusIdx)};MxpCoverItemList.prototype.setData=function(b){var a=this.data[this.focusIdx];if(!b||b.length===0){b=[this.createDummyEntry()]}this.data=b;if(a&&a.id){a=Math.max(0,this.findIdxForId(a.id))}else{a=0}this.resetView();this.setFocusIdx(a);this.navigationWrappedAround=false};MxpCoverItemList.prototype.resetView=function(){this.elems=[];this.populatedWidth=-1;this.coverband.innerHTML=""};MxpCoverItemList.prototype.createDummyEntry=function(a){return{"id":0,"dummy":true}};MxpCoverItemList.prototype.findIdxForId=function(c){var a,b;for(a=0;a<this.data.length;a++){b=this.data[a];if(b.id===c){return a}}return -1};MxpCoverItemList.prototype.setFocusIdx=function(a){var c,g,b,d=false,f=null;a=Math.max(0,Math.min(this.data.length-1,a));g=(a===this.focusIdx||this.focusIdx>=this.data.length)?-1:this.focusIdx;this.focusIdx=a;for(c=this.elems.length;c<=this.focusIdx;c++){this.addItemInt(c);d=true}a=Math.max(0,(this.focusIdx-1)*this.coveritemwidth-this.preferredfocusoffset);c=a+1280-this.selxpos;while(this.elems.length<this.data.length&&(this.elems.length-1)*this.coveritemwidth<c){this.addItemInt(this.elems.length);d=true}b=this.coverbanditemoffset+this.elems.length*this.coveritemwidth;if(d){c=b+this.coverbanditemoffset;if(c>this.populatedWidth){this.populatedWidth=Math.max(this.populatedWidth+1280,c);this.coverband.style.width=this.populatedWidth+"px"}}if(this.elems.length===this.data.length){c=b-this.coverbanditemoffset-a;c=this.pageEnd-this.selxpos-c;if(c>0){a=Math.max(0,a-c)}}this.setCoverbandScrollInt(this.selxpos-(a+this.coverbanditemoffset));if(g>=0&&this.elems[g]){this.updateElement(g)}this.updateElement(this.focusIdx);f=this.elems[this.focusIdx].elem;if(f&&f.nextSibling){this.coverband.removeChild(f);this.coverband.appendChild(f)}};MxpCoverItemList.prototype.addItemInt=function(a){var b=this.buildItem(this.data[a]);b.elem.style.left=(this.coverbanditemoffset+a*this.coveritemwidth)+"px";this.elems[a]=b;this.updateElement(a);this.coverband.appendChild(b.elem)};MxpCoverItemList.prototype.setCoverbandScrollInt=function(a){if(a===this.coverbandScrollX){return}this.coverbandScrollX=a;this.coverband.style.left=a+"px"};MxpCoverItemList.prototype.buildItem=function(g){var c,a,b={"elem":document.createElement("div")},f=GLOBALS.stats.isLargeFont()?24:28;if(g.img){c=document.createElement("img");c.src=g.img;b.elem.appendChild(c)}if(g.title){b.elem.appendChild(createClassDiv(false,false,"titleshade"));c=createClassDiv(false,false,"title");c.innerHTML=textHtmlEncode(shortenText(toStr(g.title),g.subtit?f:2*f));if(g.subtit){a=document.createElement("p");a.className="sub";a.innerHTML=textHtmlEncode(shortenText(toStr(g.subtit),f));c.appendChild(a)}b.elem.appendChild(c)}a=g.minutes?parseInt(g.minutes,10):0;if(!isNaN(a)&&a>0){c=createClassDiv(false,false,"label");c.innerHTML=textHtmlEncode(Math.round(a)+" MIN");c.appendChild(createClassDiv(false,false,"icon"));b.elem.appendChild(c)}return b};MxpCoverItemList.prototype.updateElement=function(a){var b=this.elems[a];if(b){b.elem.className="coverbanditem"+(this.focused&&a===this.focusIdx?" focus":"")}};MxpCoverItemList.prototype.applyAppLink=function(e,c){var b,a;if(!e||!e.link||!e.link.params){return}a=toStr(e.link.params);b=a.indexOf("#");if(b>=0){c.addParams=a.substring(b+1);a=a.substring(0,b)}if(a){c.addUrlParams=a}};MxpCoverItemList.prototype.openApp=function(b){var c=this.data[this.focusIdx],a={};if(!b||!c||!c.link){return}a.deeplink=c.title||"Deeplink";this.applyAppLink(c,a);GLOBALS.config.runApp(b,a)};MxpCoverItemList.prototype.navToIdx=function(a){this.setFocusIdx(a);GLOBALS.stats.loadIVW("Scroll::Content","click");return true};MxpCoverItemList.prototype.handleKeyPress=function(a){if((this.focusIdx>0&&a===VK_LEFT)||(this.focusIdx+1<this.data.length&&a===VK_RIGHT)){return this.navToIdx(this.focusIdx+(a===VK_LEFT?-1:1))}if(this.focusIdx>0&&this.focusIdx+1===this.data.length&&a===VK_RIGHT){this.navigationWrappedAround=true;return this.navToIdx(0)}if(this.focusIdx===0&&this.data.length>1&&this.navigationWrappedAround&&a===VK_LEFT){return this.navToIdx(this.data.length-1)}return false};function MxpWidgetBar(a){this.idnam=a}MxpWidgetBar.prototype=new MxpBaseObject();MxpWidgetBar.prototype.init=function(b){var a,c=createClassDiv(false,false,"widgetbar");this.covers=new MxpCoverItemList();this.covers.init(c);this.emgcy=new MxpEmgcyInfo();this.emgcy.init(c);c.appendChild(this.bgElem=createClassDiv(false,false,this.shadeBgCN="shadebg animy"));this.tabElemCN="tabbg animx";c.appendChild(this.tabElem=createClassDiv(false,false,this.tabElemCN+" hidden"));c.appendChild(this.widgetsElem=createClassDiv(false,false,"widgets animx"));c.appendChild(this.buttonsElem=createClassDiv(false,false,"buttonrow"));c.appendChild(this.colbarElem=createClassDiv(false,false,"colbar"));c.appendChild(this.noWebElem=createClassDiv(false,false,"noweb"));this.noWebElem.innerHTML="Dieses Angebot ist ohne Internet nicht verf&#x00FC;gbar. Das volle Angebot k&#x00F6;nnen Sie erst nutzen, wenn Sie Ihren Fernseher mit dem Internet verbinden. Mehr Informationen dazu finden Sie unter<br/>ard-digital.de/hbbtv";b.appendChild(c);this.baseInit(c);this.colbuttons=["Sendung neu starten","Ausblenden"];this.colEnabled={"r":true};for(a=0;a<this.colbuttons.length;a++){c={"id":this.colbuttons[a],"elem":createClassDiv(false,false,"colbutton"),"enab":true};c.col=a?"r":"b";c.elem.innerHTML=c.id;c.elem.appendChild(createClassDiv(false,false,"btn "+c.col));this.colbuttons[a]=c}this.updateButtons();this.forAllMode=null;this.barelems=[];this.lastWidgetscfg=[];this.elemIdx=0;this.showNoWebMessage(false);this.req=null;this.focusIdx=0;this.focused=false;this.setFocusIdx(0)};MxpWidgetBar.prototype.setFocused=function(a,b){this.focused=b;if(b||(a&&a.idnam==="epgbar")){this.updateElementFocus(this.focusIdx);b=true}this.elem.style.display=b?"block":"none";if(a&&a.idnam==="settingspane"){b=true}GLOBALS.epgbar.elem.style.display=b?"block":"none"};MxpWidgetBar.prototype.setFocusIdx=function(a){var d,b,c=this.focusIdx;b=this.barelems.length?(this.covers.isHidden?-1:-2):0;if(a===-3&&this.emgcy.isFocusable){b=-3}this.focusIdx=Math.max(b,Math.min(this.buttons.length-1,a));if(c!==this.focusIdx){this.updateElementFocus(c)}this.updateElementFocus(this.focusIdx);if(c!==this.focusIdx&&(c===-1||this.focusIdx===-1)){d=this.barelems[this.elemIdx];if(d){d.elem.className=d.cn;setTimeout(function(){d.elem.className=d.cn+" animx"},10)}}};MxpWidgetBar.prototype.updateElementFocus=function(a){var c,b=this.focused&&a===this.focusIdx;if(a===-3){this.emgcy.setFocused(null,b)}else{if(a===-2){this.covers.setFocused(null,b)}else{if(a===-1){this.updateElems()}else{if(a>=0&&a<this.buttons.length){c=this.buttons[a];c.elem.className=c.cn+(b?" focus":"")}}}}};MxpWidgetBar.prototype.setElemIdx=function(a){if(a<0){a=Math.max(0,this.barelems.length-1)}else{if(a>=this.barelems.length){a=0}}this.elemIdx=a;this.updateElems()};MxpWidgetBar.prototype.update=function(){this.setWidgets(this.lastWidgetscfg,{});this.updateColorBar()};MxpWidgetBar.prototype.updateColorBar=function(){var f,g,c,b,a=0,d=0,h=460;f=GLOBALS.stats.isForAll();if(f||f!==this.forAllMode){this.forAllMode=f;if(f){b="";for(f=0;f<this.colbuttons.length;f++){g=this.colbuttons[f];g.enab=this.colEnabled[g.col];if(!g.enab){continue}b+=(b?" &#160; &#160; ":"")+(g.col==="r"?"Rot":"Blau")+": "+g.id}this.colbarElem.innerHTML=b;return}this.colbarElem.innerHTML="";for(f=0;f<this.colbuttons.length;f++){this.colbarElem.appendChild(this.colbuttons[f].elem)}}for(f=0;f<this.colbuttons.length;f++){g=this.colbuttons[f];g.enab=this.colEnabled[g.col];g.elem.style.display=g.enab?"block":"none";if(!g.enab){continue}g.width=parseInt(g.elem.offsetWidth,10);if(!g.width||isNaN(g.width)||g.width<35){g.width=40+g.id.length*11}a+=g.width;d++}c=Math.max(4,Math.min(40,Math.floor(h-a)/Math.max(1,d)));a=h;for(f=this.colbuttons.length-1;f>=0;f--){g=this.colbuttons[f];if(!g.enab){continue}a-=g.width;g.elem.style.left=a+"px";a-=c}};MxpWidgetBar.prototype.updateButtons=function(){var a,c,b=!(GLOBALS.config&&GLOBALS.config.vtxapp.cfg);if(this.vtxDisabled===b){return}this.vtxDisabled=b;this.buttons=[];if(!b){this.buttons.push({"id":"ttxt","name":"Teletext","icon":"ttxt"})}this.buttons.push({"id":"sett","name":"Einstellungen","icon":"sett","ivw":"einstellungen","logid":-2});this.buttons.push({"id":"privacy","name":"Datenschutz","ivw":"datenschutz","logid":-3});this.buttons.push({"id":"imprint","name":"Impressum","ivw":"impressum","logid":-4});this.buttonsElem.innerHTML="";for(a=0;a<this.buttons.length;a++){c=this.buttons[a];c.cn="button"+(c.icon?" withicon":"");c.elem=createClassDiv(false,false,c.cn);c.elem.innerHTML=c.name;if(c.icon){c.elem.appendChild(createClassDiv(false,false,"icon "+c.icon))}this.updateElementFocus(a);this.buttonsElem.appendChild(c.elem)}if(this.focusIdx>0&&b){this.setFocusIdx(this.focusIdx-1)}};MxpWidgetBar.prototype.setWidgets=function(m,a){var g,l,j,k,h,c,b,o=0,f=-1,d,n;n=GLOBALS.stats.isForAll();d=GLOBALS.dsmccversion||n;this.lastWidgetscfg=m;b=this.elemIdx<this.barelems.length?this.barelems[this.elemIdx]:null;this.barelems=[];for(g=0;g<m.length;g++){k=m[g];if(k.awid===a.teaserfocusAwid){f=this.barelems.length}c=k.awid;l={"id":c,"cfg":k,"elem":createClassDiv(false,false,"widget"),"old":{},"deep":k.deep&&!d};if(b&&c===b.id&&!a.resetFocus){o=this.barelems.length;if(b.deepData&&l.deep){l.deepData=b.deepData}}if(d||!k.icon){h=k.name||"App";j=createClassDiv(false,false,"title");j.innerHTML=h;l.fixTitle=j}else{j=document.createElement("img");j.src=k.icon||""}l.elem.appendChild(j);l.elem.appendChild(createClassDiv(false,false,"frame"));this.barelems.push(l)}this.setElemIdx(f>=0?f:o);this.widgetsElem.innerHTML="";for(g=0;g<this.barelems.length;g++){l=this.barelems[g];this.widgetsElem.appendChild(l.elem);if(l.fixTitle){c=parseInt(l.fixTitle.offsetHeight,10);c=isNaN(c)||c<25?30:c;l.fixTitle.style.top=Math.round((94-c)/2)+"px";l.fixTitle=null}}this.updateShadeBg();this.updateButtons();if(!this.barelems.length&&this.focusIdx<0){this.setFocusIdx(0)}g=!(!GLOBALS.config.replayapp.cfg);if(this.colEnabled.b!==g||this.forAllMode===null){this.colEnabled.b=g;this.updateColorBar()}if(this.focusIdx!==-1&&a.resetFocus&&this.barelems.length){this.setFocusIdx(-1)}if(a.emgcy){this.emgcy.setData(a.emgcy)}};MxpWidgetBar.prototype.updateElems=function(){var c=0,b,j,d,g,h,f,a;if(!this.barelems.length){return}for(d=0;d<this.barelems.length;d++){g=this.barelems[d];f=this.elemIdx===d;h=f&&this.focusIdx===-1&&this.focused;a=f&&!h?10:0;if(a){if(!g.deep){a=0;f=false}else{if(f){a=0}}}if(f){c+=8}g.tabxpos=c;b=c+a;if(b!==g.xpos){g.xpos=b;g.elem.style.left=b+"px"}j="widget"+(h?" focus":(f?" sel":""));if(j!==g.cn){g.cn=j;g.elem.className=j+" animx"}c+=163+(f?20+8:0)}if(c!==this.widgetsWidth){this.widgetsWidth=c;this.widgetsElem.style.width=c+"px"}c=Math.max(0,c-20+4-1152);c=(c&&this.barelems.length>2)?Math.round(c*this.elemIdx/(this.barelems.length-1)):0;c=64-c;if(c!==this.widgetsScrollPos){this.widgetsScrollPos=c;this.widgetsElem.style.left=c+"px"}this.updateTab()};MxpWidgetBar.prototype.updateTab=function(){var a,b,c=this.barelems[this.elemIdx];if(!c){return}a=c.tabxpos+this.widgetsScrollPos-24;this.tabElem.style.left=a+"px";this.tabElem.className=this.tabElemCN+(c.deep?"":" hidden");a=c.deep&&c.deepData;this.covers.setHidden(!a);this.updateShadeBg();if(!a&&this.focusIdx===-2){this.setFocusIdx(-1)}if(c.deep&&!c.deepData){if(c.id===this.loadingDeepId){return}b=this;abortHttpRequest(this.req);this.loadingDeepId=c.id;this.req=createHttpRequest("api/deep.php?awid="+c.id,function(d){var f,e;if(b.loadingDeepId===c.id){b.loadingDeepId=null;b.req=null}d=parseJSON(d);if(d&&d.teaser&&d.teaser.length){for(f=0;f<b.barelems.length;f++){e=b.barelems[f];if(e&&e.deep&&e.id===c.id){e.deepData=d}}b.updateTab()}});return}if(c.deep){if(this.currentDeepData!==c.deepData){this.currentDeepData=c.deepData||[];this.covers.setData(this.currentDeepData.teaser)}}};MxpWidgetBar.prototype.updateShadeBg=function(){var a="shadebg animy";if(!this.barelems.length){a+=" low";this.tabElem.className=this.tabElemCN+" hidden";this.covers.setHidden(true)}else{if(this.covers.isHidden){a+=" high"}}if(this.shadeBgCN===a){return}this.shadeBgCN=a;this.bgElem.className=a};MxpWidgetBar.prototype.sendShowCpix=function(){var a=GLOBALS.stats.cookies.info.fsize;if(a===1){a="Gross"}else{if(a===2){a="Kontrast"}else{if(a===3){a="FuerAlle"}else{a="Standard"}}}if(GLOBALS.stats.cookies.info.subtitcfg&1){a+="UT"}GLOBALS.stats.loadIVW("Start::"+GLOBALS.video.serviceidsd+"::"+a)};MxpWidgetBar.prototype.showNoWebMessage=function(a){if(this.showingNoWebMessage===a){return}this.showingNoWebMessage=a;this.noWebElem.style.display=a?"block":"none"};MxpWidgetBar.prototype.runFocusedButton=function(){var a=this.buttons[this.focusIdx];if(!a){return}if(a.logid){GLOBALS.stats.logstat(a.logid,1)}if(a.id==="sett"){GLOBALS.settingspane.requestFocus();GLOBALS.stats.loadIVW(a.ivw)}else{if(a.id==="privacy"||a.id==="imprint"){GLOBALS.textpane.show(a.id,a.ivw)}else{if(a.id==="ttxt"){GLOBALS.config.runApp(GLOBALS.config.vtxapp.cfg,{"barbutton":1})}}}};MxpWidgetBar.prototype.handleKeyPress=function(a){if(a===VK_UP){if(this.focusIdx>=0&&this.barelems.length){this.setFocusIdx(-1);return true}if(this.focusIdx===-1&&!this.covers.isHidden){this.setFocusIdx(-2);return true}if((this.focusIdx===-1||this.focusIdx===-2)&&this.emgcy.isFocusable){this.setFocusIdx(-3);return true}if(!GLOBALS.dsmccversion&&GLOBALS.config.epgapp.cfg){GLOBALS.epgbar.requestFocus()}return true}if(a===VK_DOWN){if(this.focusIdx===-3){this.setFocusIdx(this.covers.isHidden?-1:-2)}else{if(this.focusIdx===-2){this.setFocusIdx(-1)}else{if(this.focusIdx<0){this.setFocusIdx(0)}}}return true}if(a===VK_LEFT||a===VK_RIGHT){this.showNoWebMessage(false);if(this.focusIdx>=0){this.setFocusIdx(Math.max(0,this.focusIdx+(a===VK_LEFT?-1:1)))}else{if(this.focusIdx===-1){if((a===VK_LEFT&&this.elemIdx>0)||(a===VK_RIGHT&&this.elemIdx<this.barelems.length-1)){this.setElemIdx(this.elemIdx+(a===VK_LEFT?-1:1));GLOBALS.stats.loadIVW("Scroll::Widget","click")}}else{if(this.focusIdx===-2){this.covers.handleKeyPress(a)}}}return true}if(a===VK_ENTER){this.showNoWebMessage(false);if(this.focusIdx===-1){if(!GLOBALS.config.runApp(this.barelems[this.elemIdx].cfg,{})){this.showNoWebMessage(true)}}else{if(this.focusIdx===-2){this.covers.openApp(this.barelems[this.elemIdx].cfg)}else{if(this.focusIdx===-3){this.emgcy.openApp()}else{this.runFocusedButton()}}}return true}return false};function MxpSettingsPane(a){this.idnam=a}MxpSettingsPane.prototype=new MxpBaseObject();MxpSettingsPane.prototype.init=function(b){var a,c=createClassDiv(false,false,"settingspane fullscrn");c.appendChild(this.bgElem=createClassDiv(false,false,"shadebg"));c.appendChild(createClassDiv(false,false,"dashline p1"));c.appendChild(this.lineA=createClassDiv(false,false,"dashline p2 p2a"));c.appendChild(this.lineB=createClassDiv(false,false,"dashline p2 p2b"));c.appendChild(this.lineC=createClassDiv(false,false,"dashline p2 p2c"));c.appendChild(this.panell=createClassDiv(false,false,"panel left"));this.panell.appendChild(this.panellTitle=createClassDiv(false,false,"paneltitle"));this.panellTitle.innerHTML="Ansicht";c.appendChild(this.panelc=createClassDiv(false,false,"panel cntr"));c.appendChild(this.panelr=createClassDiv(false,false,"panel right"));this.panelr.appendChild(this.panelrTitle=createClassDiv(false,false,"paneltitle"));c.appendChild(this.buttonsElem=createClassDiv(false,false,"buttonrow"));b.appendChild(c);this.allowForAll=GLOBALS.stats.cookies.info.fsize===3;try{if(GLOBALS.stats.uagent.toUpperCase().indexOf("MAPLE")<0){this.allowForAll=true}}catch(d){}this.baseInit(c);this.audioLangs=[{"name":"Standardton","language":"deu","ctag":17,"altCtag":2},{"name":"mit Audiodeskription","language":"mis","ctag":4},{"name":"Klare Sprache","language":"qks","ctag":5}];this.opts=[{"name":"Standard"},{"name":"Schrift vergr\u00f6\u00dfern"},{"name":"Kontrast erh\u00f6hen"}];if(this.allowForAll){this.opts.push({"name":"Startleiste f\u00fcr alle"})}for(a=0;a<this.opts.length;a++){c=this.opts[a];c.elem=createClassDiv(false,a*46,"usropt");c.elem.innerHTML=c.name;c.elem.appendChild(c.opt=createClassDiv(false,false,"opt"));this.panell.appendChild(c.elem)}this.rightOpt={"elem":createClassDiv(false,0,"usropt"),"opt":createClassDiv(false,false,"opt chk")};this.panelr.appendChild(this.rightOpt.elem);this.cfgButton=createClassDiv(false,false,"cfgbutton");this.cfgButton.innerHTML="Anpassen";this.panelr.appendChild(this.cfgButton);this.backButton=createClassDiv(false,false,"button withicon");this.backButton.innerHTML="Zur\u00fcck";this.backButton.appendChild(createClassDiv(false,false,"icon back"));this.buttonsElem.appendChild(this.backButton);this.elem.appendChild(this.debugElem=createClassDiv(false,false,"uainfo"));this.focused=false;this.hiddenKeys=[1,1,2,1,2];this.pinText="";this.setFocused(null,false);if(GLOBALS.overrideaudio){this.applyAudioEmulation()}};MxpSettingsPane.prototype.applyAudioEmulation=function(){var a=document.getElementById("video");a.activeComponentIdx=0;a.getComponents=function(){return[{"_idx":0,"language":"deu","componentTag":2},{"_idx":1,"language":"mis","componentTag":4},{"_idx":2,"language":"qks","componentTag":5}]};a.getCurrentActiveComponents=function(){return[a.getComponents()[a.activeComponentIdx]]};a.selectComponent=function(b){a.activeComponentIdx=b._idx}};MxpSettingsPane.prototype.setFocused=function(a,b){this.elem.style.display=b?"block":"none";if(b!==this.focused){this.focused=b;if(b){GLOBALS.focusmgr.pushKeyset(MxpFocusManager.KEYSET_TEXTENTRY)}else{GLOBALS.focusmgr.popKeyset()}}if(b){this.loadConfig();this.setFocusIdx(-1)}};MxpSettingsPane.prototype.loadConfig=function(){var b,c,a=GLOBALS.stats.cookies.info.fsize;b=svcinfo[toStr(GLOBALS.video.serviceid)];this.withRadio=b&&0===b.tv;this.selectedOpt=a;for(b=0;b<this.opts.length;b++){c=this.opts[b];c.opt.className="opt rad"+(b===a?"sel":"")}this.optsc=null;this.selectedOptC=0;this.panelc.style.display="none";this.panelrTitle.innerHTML=this.withRadio?"Radio-Hintergrundbilder":"Untertitel";this.rightOpt.elem.innerHTML=this.withRadio?"ausblenden":"anzeigen";this.rightOpt.elem.appendChild(this.rightOpt.opt);this.updateRightPanel(false);this.hiddenKeyIdx=0;this.hiddenKeyTime=0;this.pinText="";this.debugElem.style.display="none";this.checkAudioLanguages(false);this.lineA.style.display=this.optsc?"none":"block";this.lineB.style.display=this.lineC.style.display=this.panelc.style.display=this.optsc?"block":"none";this.panelr.className="panel right"+(this.optsc?"2":"");this.rPaneFocIdx=this.opts.length+(this.optsc?this.optsc.length:0)};MxpSettingsPane.prototype.checkAudioLanguages=function(c){var d,g,m,l,o,k,j=[],b={},f=0,a=[],n=document.getElementById("video");try{if(c&&!GLOBALS.stats.cookies.info.langcfg){return}if(vidstreaming.streamInfo){k=null;if(vidstreaming.streamInfo.audioTracks&&vidstreaming.streamInfo.audioTracks.length>1){for(d=0;d<vidstreaming.streamInfo.audioTracks.length;d++){m=vidstreaming.streamInfo.audioTracks[d];if(m){l={"language":m,"componentTag":0};b[m]=l;if(vidstreaming.filter&&vidstreaming.filter.atr===d){k=l}j.push(m+"_")}}}}else{l=n?n.getComponents(n.COMPONENT_TYPE_AUDIO):null;l=l&&l.length?l:null;k=l?n.getCurrentActiveComponents(n.COMPONENT_TYPE_AUDIO):null;k=k&&k.length?k[0]:null;for(d=0;l&&d<l.length;d++){m=l[d];if(m&&m.language){g=toStr(m.language);j.push(g+"-"+m.componentTag);b[g]=m;try{if(m.componentTag){b["ct_"+m.componentTag]=m}}catch(h){}}else{j.push("-")}}}if(!b.deu){return j}try{for(d=0;d<this.audioLangs.length;d++){m=this.audioLangs[d];l=b["ct_"+m.ctag];if(l||(m.altCtag&&b["ct_"+m.altCtag])){f++}}}catch(h){}g=-1;for(d=0;d<this.audioLangs.length;d++){m=this.audioLangs[d];l=b[m.language];o=!l&&f>=this.audioLangs.length;if(o){l=b["ct_"+m.ctag]}if(l){if(k&&(o?k.componentTag===m.ctag:k.language===m.language)){this.selectedOptC=a.length}else{if(GLOBALS.stats.cookies.info.langcfg===m.language){g=a.length}}a.push({"name":m.name,"vc":l,"lang":(m.language==="deu"?"":m.language)})}}if(a.length<2){return j}c=(c&&g>=0)?g:-1;this.panelc.innerHTML="";this.panelc.appendChild(d=createClassDiv(false,false,"paneltitle"));d.innerHTML="Audiokanal";for(d=0;d<a.length;d++){g=a[d];g.elem=createClassDiv(false,d*46,"usropt");g.elem.innerHTML=g.name;g.elem.appendChild(g.opt=createClassDiv(false,false,"opt rad"+(d===this.selectedOptC?"sel":"")));this.panelc.appendChild(g.elem)}this.optsc=a;this.panelc.style.display="block";if(c>=0){this.activateAudio(c)}if(this.focusIdx&&this.focusIdx>=this.opts.length){this.setFocusIdx(this.focusIdx)}}catch(h){}return j};MxpSettingsPane.prototype.activateAudio=function(k){var c,d,g,b,a=this.optsc,h=this,j=document.getElementById("video");g=a?a[k]:null;b=g?toStr(g.lang||""):"";if(vidstreaming.streamInfo){g=null}else{g=g?g.vc:null;if(!g){return}try{j.unselectComponent(j.COMPONENT_TYPE_AUDIO)}catch(f){}}setTimeout(function(){try{if(g){j.selectComponent(g)}for(c=0;c<h.optsc.length;c++){d=h.optsc[c];d.opt.className="opt rad"+(c===k?"sel":"")}if(b!==GLOBALS.stats.cookies.info.langcfg){GLOBALS.stats.cookies.info.langcfg=b;GLOBALS.stats.cookies.saveCookie(GLOBALS.dsmccversion);GLOBALS.stats.loadIVW("Einstellungen::Audiosprache::"+(b||"Standard")+"::"+GLOBALS.video.serviceidsd,"click");if(!g&&vidstreaming.streamInfo){vidstreaming.filter=GLOBALS.video.buildFilter(null);if(vidstreaming.filter){GLOBALS.video.startStreaming(vidstreaming.streamInfo)}}}}catch(e){}},g?500:10)};MxpSettingsPane.prototype.setFocusIdx=function(a){var b,c,d="usropt fixedwidth"+(this.optsc?"2":"");this.focusIdx=Math.max(-1,Math.min(this.rPaneFocIdx-1+(this.rightOptAvailable?1+(this.cfgButtonApp?1:0):0),a));this.backButton.className="button withicon"+(this.focusIdx<0?" focus":"");for(b=0;b<this.opts.length;b++){c=this.opts[b];c.elem.className=d+(b===this.opts.length-1?" large":"")+(b===this.focusIdx?" focus":"")}if(this.optsc){for(b=0;b<this.optsc.length;b++){c=this.optsc[b];c.elem.className=d+(b+this.opts.length===this.focusIdx?" focus":"")}}this.rightOpt.elem.className=d+(this.focusIdx===this.rPaneFocIdx?" focus":"");this.cfgButton.className="cfgbutton"+(this.focusIdx===this.rPaneFocIdx+1?" focus":"")};MxpSettingsPane.prototype.updateRightPanel=function(d){var b=GLOBALS.stats.cookies;var a=this.withRadio?"nobg":"subtitcfg";var c=b.info[a];if(!this.withRadio){c=c&1}if(d){c=c?0:1;b.info[a]=this.withRadio?c:((b.info[a]&16777214)+c);setTimeout(function(){b.saveCookie(GLOBALS.dsmccversion)},3000);if(!vidstreaming.streamInfo){GLOBALS.video.applyServiceId()}GLOBALS.video.configureStreamingSubtitles(true);GLOBALS.stats.loadIVW("Einstellungen::"+(this.withRadio?"Hintergrundbild":"Untertitel")+"::"+(c?"An":"Aus")+"::"+GLOBALS.video.serviceidsd,"click");if(a==="subtitcfg"){GLOBALS.config.loadConfig(true)}}this.subtitAvailable=GLOBALS.config.subtitleapp.cfg&&(vidstreaming.streamInfo?vidstreaming.hasSubtitles:GLOBALS.streamEventSupport>=0);this.rightOptAvailable=this.withRadio||this.subtitAvailable;this.panelrTitle.style.display=this.rightOpt.elem.style.display=this.rightOptAvailable?"block":"none";this.rightOpt.opt.className="opt chk"+(c?"sel":"");this.cfgButtonApp=!this.withRadio&&c&&this.subtitAvailable?GLOBALS.config.subtitleapp.cfg:null;this.cfgButton.style.display=this.cfgButtonApp?"block":"none"};MxpSettingsPane.prototype.handleHiddenKey=function(d){var a,c,b=(new Date()).getTime();if(this.hiddenKeyTime+1800<b){this.hiddenKeyIdx=0}if(this.hiddenKeys[this.hiddenKeyIdx]!==d){this.hiddenKeyIdx=0;return}this.hiddenKeyIdx++;this.hiddenKeyTime=b;if(this.hiddenKeyIdx===this.hiddenKeys.length){c=GLOBALS.settingspane.checkAudioLanguages(false);a=textHtmlEncode(GLOBALS.subtitles.handlerRegisteredStreamId+","+GLOBALS.subtitles.isseventregistered+", "+(GLOBALS.config.subtitleapp.cfg?1:0)+", "+(vidstreaming.streamInfo?vidstreaming.hasSubtitles:GLOBALS.streamEventSupport)+", "+GLOBALS.config.debugtxt+", "+GLOBALS.subtitles.delayms+", audio="+c.join("/"))+"<br/>"+textHtmlEncode(GLOBALS.stats.uagent);c=vidstreaming.streamInfo;c=c?(c.isBackup?c.backupUrl:c.mainUrl):null;if(c){a+="<br/>stream: "+textHtmlEncode(c)}this.debugElem.innerHTML=a;this.debugElem.style.display="block";this.hiddenKeyIdx=0}};MxpSettingsPane.prototype.handlePinEntry=function(a){if(a===VK_0){a="0"}else{if(a===VK_1){a="1"}else{if(a===VK_2){a="2"}else{if(a===VK_3){a="3"}else{if(a===VK_4){a="4"}else{if(a===VK_5){a="5"}else{if(a===VK_6){a="6"}else{if(a===VK_7){a="7"}else{if(a===VK_8){a="8"}else{if(a===VK_9){a="9"}else{return false}}}}}}}}}}this.pinText+=a;this.hiddenKeyIdx=0;this.debugElem.innerHTML="PIN: ***********".substring(0,5+this.pinText.length);this.debugElem.style.display="block";if(this.pinText.length>=10){this.validatePin()}return true};MxpSettingsPane.prototype.cancelPinEntry=function(){if(!this.pinText){return}this.pinText="";this.debugElem.innerHTML="";this.debugElem.style.display="none"};MxpSettingsPane.prototype.validatePin=function(){var a=this;if(this.pinText==="9689"){a=GLOBALS.stats.cookies.info.xcfg?0:1;GLOBALS.stats.cookies.info.xcfg=a;GLOBALS.stats.cookies.saveCookie(false);this.debugElem.innerHTML="Tasten-Test "+(a?"aktiv":"inaktiv");return}if(this.pinText.length<5){this.debugElem.innerHTML="PIN falsch";return}createHttpRequest("api/validatepin.php?pin="+encodeURIComponent(this.pinText)+"&dvbsid="+GLOBALS.video.serviceidsd,function(b){b=parseJSON(b);if(!b||!b.correct){a.debugElem.innerHTML="PIN falsch";this.pinText="";return}if(b.showTest){GLOBALS.params.showtest=true;if(GLOBALS.config.config){GLOBALS.config.config.version="1"}GLOBALS.config.loadConfig(true)}if(b.badwid){a.debugElem.innerHTML="Widget ID "+b.badwid+" falsch";this.pinText="";return}if(b.widget){a.debugElem.innerHTML="Starte...";GLOBALS.config.runApp(b.widget,b.widgetOpts||{});return}a.close()});this.pinText=""};MxpSettingsPane.prototype.close=function(){this.cancelPinEntry();GLOBALS.widgetbar.requestFocus();GLOBALS.stats.loadIVW("einstellungenAus");if(this.updateWidgetbarOnClose){this.updateWidgetbarOnClose=false;GLOBALS.widgetbar.update()}};MxpSettingsPane.prototype.handleKeyPress=function(a){if(a===VK_LEFT||a===VK_RIGHT){this.cancelPinEntry();this.handleHiddenKey(a===VK_LEFT?1:2)}if(a===VK_LEFT){if(this.focusIdx>=this.rPaneFocIdx){this.setFocusIdx(this.optsc?this.opts.length+this.selectedOptC:this.selectedOpt)}else{if(this.focusIdx>=this.opts.length){this.setFocusIdx(this.selectedOpt)}}return true}if(a===VK_RIGHT){if(this.focusIdx>=0&&this.focusIdx<this.opts.length&&(this.optsc||this.rightOptAvailable)){this.setFocusIdx(this.optsc?this.opts.length+this.selectedOptC:this.rPaneFocIdx)}else{if(this.focusIdx<this.rPaneFocIdx&&this.rightOptAvailable){this.setFocusIdx(this.rPaneFocIdx)}}return true}if(a===VK_UP||a===VK_DOWN){this.cancelPinEntry();if(this.focusIdx<0&&a===VK_UP){this.setFocusIdx(this.opts.length-1)}else{if((this.focusIdx===this.opts.length-1||this.focusIdx===this.rPaneFocIdx-1)&&a===VK_DOWN){this.setFocusIdx(-1)}else{if(this.focusIdx>=0&&this.focusIdx<this.opts.length){this.setFocusIdx(Math.max(0,this.focusIdx+(a===VK_UP?-1:1)))}else{if(this.optsc&&this.focusIdx>=this.opts.length&&this.focusIdx<this.opts.length+this.optsc.length){this.setFocusIdx(Math.max(this.opts.length,this.focusIdx+(a===VK_UP?-1:1)))}else{if(this.focusIdx===this.rPaneFocIdx+1){this.setFocusIdx(a===VK_UP?this.focusIdx-1:-1)}else{if(this.focusIdx===this.rPaneFocIdx&&a===VK_DOWN){this.setFocusIdx(this.cfgButtonApp?this.focusIdx+1:-1)}}}}}}return true}if(a===VK_ENTER){if(this.pinText){this.validatePin()}else{if(this.focusIdx===this.rPaneFocIdx){this.updateRightPanel(true)}else{if(this.focusIdx===this.rPaneFocIdx+1){GLOBALS.config.runApp(this.cfgButtonApp,{})}else{if(this.focusIdx>=0&&this.focusIdx<this.opts.length){GLOBALS.stats.setFSize(this.focusIdx);GLOBALS.epgbar.update();this.updateWidgetbarOnClose=true;GLOBALS.widgetbar.sendShowCpix();this.loadConfig();this.setFocusIdx(this.selectedOpt)}else{if(this.optsc&&this.focusIdx>=this.opts.length&&this.focusIdx<this.opts.length+this.optsc.length){this.activateAudio(this.focusIdx-this.opts.length)}else{this.close()}}}}}return true}if(a===VK_BACK){this.close();return true}if(this.handlePinEntry(a)){return true}return false};function MxpTextPane(a){this.idnam=a}MxpTextPane.prototype=new MxpBaseObject();MxpTextPane.prototype.init=function(b){var a,c=createClassDiv(false,false,"textpane fullscrn");c.appendChild(createClassDiv(false,false,"fullscrn shadebg"));c.appendChild(createClassDiv(false,false,"dashline p1"));c.appendChild(createClassDiv(false,false,"dashline p2"));c.appendChild(this.textcontainerElem=createClassDiv(false,false,"textcontainer"));this.textcontainerElem.appendChild(this.textscrollElem=createClassDiv(false,false,"text animy"));c.appendChild(this.rtextElem=createClassDiv(false,false,"rtext"));c.appendChild(this.buttonsElem=createClassDiv(false,false,"buttonrow"));b.appendChild(c);this.baseInit(c);this.buttons=[];for(a=0;a<3;a++){c={"elem":createClassDiv(false,false,"button"),"outr":createClassDiv(false,false,"buttonrow textnav")};c.outr.appendChild(c.elem);c.outr.style.textAlign=a?(a===1?"right":"center"):"left";this.elem.appendChild(c.outr);this.buttons[a]=c}this.opts=[{"id":1,"txt":"Funktionale Einstellungen"},{"id":4,"txt":"Datenerhebung nach ATI"},{"id":32,"txt":"Datenerhebung nach Nielsen"},{"id":8,"txt":"Nutzungsstatistik"}];for(a=0;a<this.opts.length;a++){c=this.opts[a];c.elem=createClassDiv(false,327+a*46,"usropt");c.elem.innerHTML=c.txt;c.elem.appendChild(c.opt=createClassDiv(false,false,"opt"));this.elem.appendChild(c.elem)}this.backButton=createClassDiv(false,false,"button withicon");this.backButton.innerHTML="Zur\u00fcck";this.backButton.appendChild(createClassDiv(false,false,"icon back"));this.buttonsElem.appendChild(this.backButton);this.pageHeight=468;this.dialog=createClassDiv(false,false,"msgdialog");this.dialog.style.display="none";this.dialog.appendChild(createClassDiv(false,false,"bg"));this.dialog.appendChild(this.dialogBorder=createClassDiv(false,false,"border"));this.dialogBorder.appendChild(this.dialogText=createClassDiv(false,false,"txt"));this.dialogButtons=["Ja","Nein"];for(a=0;a<this.dialogButtons.length;a++){c=createClassDiv(false,false,"button");c.innerHTML=this.dialogButtons[a];c.style.left=(Math.floor((780+30-200*this.dialogButtons.length)/2)+a*200)+"px";this.dialogBorder.appendChild(c);this.dialogButtons[a]=c}this.dialogShowing=false;this.dialogOption=0;this.elem.appendChild(this.dialog);this.setFocused(null,false);this.logid=""};MxpTextPane.prototype.setFocused=function(a,b){this.elem.style.display=b?"block":"none";this.closeDialog()};MxpTextPane.prototype.show=function(d,a){var b,g,f=this,c=d==="privacy";this.logid=a||"";this.requestFocus();this.optionsEnabled=c;this.setFocusIdx(-1);for(b=0;b<2;b++){g=this.buttons[b];g.elem.innerHTML=b?"&gt;&gt;":"&lt;&lt;"}GLOBALS.config.loadPrivacyText(d,c?"Datenschutz":"Impressum",function(e){var h,j="";if(!e){return}if(c){j="<h1>Cookies</h1><p>Mit \u00dcbertragung der ARD Startapplikation werden auch Cookies gesetzt.</p><p>Ein sogenannter Cookie ist eine kleine Datei, die von einem Webserver an Ihren Browser \u00fcbermittelt und von diesem bei jedem Zugriff auf eine neue Seite mitgeschickt wird.</p>"}else{h=e.indexOf("<br/>RBB:");if(h>0){j="<h1>&#160;</h1>"+e.substring(h+5);e=e.substring(0,h)}}f.setText(e);f.rtextElem.innerHTML=j});this.updateCookieSettings();GLOBALS.stats.loadIVW(this.logid)};MxpTextPane.prototype.updateCookieSettings=function(){var b,c,a;for(b=0;b<this.opts.length;b++){c=this.opts[b];a=(GLOBALS.stats.cookies.info.cookies&c.id)===0;c.elem.style.display=this.optionsEnabled?"block":"none";c.opt.className="opt chk"+(a?"sel":"")}};MxpTextPane.prototype.setText=function(a){var b;this.textscrollElem.innerHTML=a;b=parseInt(this.textscrollElem.offsetHeight,10);if(!b||isNaN(b)||b<100){b=100}this.pages=b<570?1:Math.ceil((b+6)/this.pageHeight);this.textcontainerElem.className="textcontainer"+(this.pages<2?" onepage":"");this.buttons[2].outr.style.display=this.pages>1?"block":"none";this.setPage(0);if(this.pages<2&&(this.focusIdx===0||this.focusIdx===1)){this.setFocusIdx(-1)}};MxpTextPane.prototype.setPage=function(a){this.page=Math.max(0,Math.min(this.pages-1,a));this.hasBack=this.page>0;this.hasNext=this.page+1<this.pages;this.textscrollElem.style.top=(36-this.page*this.pageHeight)+"px";this.buttons[0].outr.style.display=this.hasBack?"block":"none";this.buttons[1].outr.style.display=this.hasNext?"block":"none";this.buttons[2].elem.innerHTML=(this.page+1)+"/"+this.pages;if(this.focusIdx===0&&!this.hasBack){this.setFocusIdx(1)}else{if(this.focusIdx===1&&!this.hasNext){this.setFocusIdx(0)}else{this.setFocusIdx(this.focusIdx)}}};MxpTextPane.prototype.setFocusIdx=function(a){var d,b,c;this.focusIdx=Math.max(-1,Math.min(1+this.opts.length,a));this.backButton.className="button withicon "+(this.focusIdx<0?" focus":"");for(b=0;b<2;b++){d="button "+(this.focusIdx===b?"":"no")+"focus";if((this.page===0&&!b)||(this.page+1>=this.pages&&b)){d+=" disab"}this.buttons[b].elem.className=d}for(b=0;b<this.opts.length;b++){c=this.opts[b];c.elem.className="usropt fixedwidth"+(this.focusIdx===b+2?" focus":"")}};MxpTextPane.prototype.showDialog=function(a,b){this.dialogText.innerHTML=a;this.dialogOnClose=b;this.dialogShowing=true;this.dialog.style.display="block";this.setDialogOption(1)};MxpTextPane.prototype.setDialogOption=function(a){this.dialogOption=Math.max(0,Math.min(this.dialogButtons.length,a));for(a=0;a<this.dialogButtons.length;a++){this.dialogButtons[a].className="button"+(a===this.dialogOption?" focus":"")}};MxpTextPane.prototype.closeDialog=function(){this.dialogShowing=false;this.dialog.style.display="none"};MxpTextPane.prototype.toggleCookie=function(b,e){var a,d=GLOBALS.stats.cookies,c=this,f=false;f=GLOBALS.stats.trackCfg!==GLOBALS.stats.rbpTrackCfg;if((d.info.cookies&b)===0){if(!e){a=b>1?"Diese Cookies dienen der Erhebung statistischer Messwerte: Zur Messung von Zugriffszahlen oder statistischen Erfassung der Anzahl der am Markt befindlichen HbbTV Ger&#x00E4;te. Es werden ausschlie&#x00DF;lich anonyme Messwerte erhoben, die keiner Person und keinem Ger&#x00E4;t zugeordnet werden.":"Mit diesem Cookie werden ausschlie&#x00DF;lich die von Ihnen gew&#x00E4;hlten Einstellungen der ARD Startleiste (z.B. die Schriftgr&#x00F6;&#x00DF;e) gespeichert. Ohne dieses Cookie gehen alle Einstellungen beim Verlassen der ARD Startleiste verloren.";this.showDialog(a+"<br />Wollen Sie das Cookie deaktivieren?",function(g){if(g===0){c.toggleCookie(b,true)}});return}d.info.cookies=d.info.cookies|b}else{d.info.cookies=d.info.cookies&(65535^b)}if(!GLOBALS.stats.isStatisticsAllowed("logstat")){GLOBALS.stats.cookies.info.u="0"}d.saveCookie(GLOBALS.dsmccversion);if(f){GLOBALS.stats.trackCfg=d.info.cookies;GLOBALS.stats.logstat(this.getCookieLogstatId(b),1)}this.updateCookieSettings()};MxpTextPane.prototype.getCookieLogstatId=function(a){var b=1;while(a>1){a=Math.round(a/2);b++}return -20-b};MxpTextPane.prototype.close=function(){GLOBALS.widgetbar.requestFocus();GLOBALS.stats.loadIVW(this.logid+"Aus");this.setPage(0)};MxpTextPane.prototype.runAction=function(){var a;if(this.focusIdx<0){this.close()}else{if(this.focusIdx===0||this.focusIdx===1){this.setPage(this.page+(this.focusIdx===0?-1:1))}else{if(this.focusIdx>1){a=this.opts[this.focusIdx-2];this.toggleCookie(a.id,false)}}}};MxpTextPane.prototype.handleKeyPress=function(a){if(this.dialogShowing){if(a===VK_LEFT||a===VK_RIGHT){this.setDialogOption(a===VK_LEFT?0:1)}else{if(a===VK_BACK||a===VK_ENTER){this.closeDialog();if(a===VK_ENTER&&this.dialogOnClose){this.dialogOnClose(this.dialogOption)}return true}}}else{if(this.focusIdx<0){if(a===VK_UP){if(this.pages>1){this.setFocusIdx(this.hasBack?0:1)}else{if(this.optionsEnabled){this.setFocusIdx(1+this.opts.length)}}}}else{if(this.focusIdx<2){if(a===VK_DOWN){this.setFocusIdx(-1)}else{if(this.focusIdx===1&&a===VK_LEFT){this.setFocusIdx(this.hasBack?0:-1)}else{if(this.focusIdx===0&&a===VK_RIGHT&&this.hasNext){this.setFocusIdx(1)}else{if(this.optionsEnabled&&(a===VK_RIGHT||a===VK_UP)){this.setFocusIdx(1+this.opts.length)}}}}}else{if(a===VK_LEFT||(a===VK_DOWN&&this.focusIdx===1+this.opts.length)){this.setFocusIdx(this.pages>1?(this.hasNext?1:0):-1)}else{if(a===VK_UP||a===VK_DOWN){this.setFocusIdx(Math.max(2,this.focusIdx+(a===VK_UP?-1:(this.hasNext?1:0))))}}}}}if(a===VK_UP||a===VK_DOWN||a===VK_LEFT||a===VK_RIGHT){return true}if(a===VK_ENTER){this.runAction();return true}if(a===VK_BACK){this.close();return true}return false};function initapp(){var a;initHbbTV(MxpFocusManager.KEYSET_ENABLED);GLOBALS.stats=new MxpStats();GLOBALS.subtitles=new MxpSubtitle(GLOBALS.stats.isSEventSupport()?2:true);GLOBALS.hidemgr=new MxpHideManager("hidemsg","appscreen");GLOBALS.stats.init();GLOBALS.params=new MxpParams();GLOBALS.time=new MxpTime();GLOBALS.video=new MxpVideo();GLOBALS.video.initOverlay();GLOBALS.config=new MxpConfig();GLOBALS.hidemsg=new MxpHideMsg();GLOBALS.epgbar=new MxpEpgBar("epgbar");GLOBALS.widgetbar=new MxpWidgetBar("widgetbar");GLOBALS.settingspane=new MxpSettingsPane("settingspane");GLOBALS.textpane=new MxpTextPane("textpane");GLOBALS.epgdetail=new MxpEpgDetail("epgdetail");GLOBALS.params.parseHash();GLOBALS.stats.manageStatistics();if((GLOBALS.stats.cookies.info.xcfg&1)>0){GLOBALS.stats.debugPrintKeys()}a=GLOBALS.hidemgr.appscreenelem;GLOBALS.epgbar.init(a);GLOBALS.widgetbar.init(a);GLOBALS.settingspane.init(a);GLOBALS.textpane.init(a);GLOBALS.epgdetail.init(a);GLOBALS.widgetbar.requestFocus();GLOBALS.video.initVideo();GLOBALS.config.loadConfig(true);GLOBALS.focusmgr.handleGlobalKey=function(c){var b=0;if(c===VK_RED){GLOBALS.hidemgr.setHidden(!GLOBALS.focusmgr.hidden);if(GLOBALS.focusmgr.hidden){GLOBALS.stats.logstat(-1,1);GLOBALS.stats.loadIVW("einblenden",0);GLOBALS.stats.trackCfg=GLOBALS.stats.cookies.info.cookies}else{GLOBALS.config.reloadConfigIfOld();GLOBALS.stats.logstat(0,1);GLOBALS.widgetbar.sendShowCpix()}if(!GLOBALS.stats.cookies.info.rbp){GLOBALS.stats.cookies.info.rbp=1;GLOBALS.stats.cookies.saveCookie(GLOBALS.dsmccversion)}return true}if(c===VK_GREEN){b=1}else{if(c===VK_YELLOW){b=2}else{if(c===VK_BLUE){b=3}}}if(b){if((b===3||GLOBALS.focusmgr.hidden)&&GLOBALS.hidemsg.runColorApp(b)){return true}if(!GLOBALS.focusmgr.hidden){return true}}return false};if(GLOBALS.params.hashparams.privacy||GLOBALS.gotoid==="privacy"){GLOBALS.textpane.show("privacy");if(!GLOBALS.stats.cookies.info.rbp){GLOBALS.stats.cookies.info.rbp=1;GLOBALS.stats.cookies.saveCookie(GLOBALS.dsmccversion)}}else{if(GLOBALS.params.hashparams.imprint||GLOBALS.gotoid==="imprint"){GLOBALS.textpane.show("imprint")}}}function restartApp(){GLOBALS.video.stopStreaming(function(){abortHttpRequest(GLOBALS.config.req);setTimeout(function(){closeHbbTV();try{document.getElementById("appmgr").getOwnerApplication(document).destroyApplication()}catch(a){if(GLOBALS.dsmccversion){return}document.location.reload(false)}},200)})}function mydebug(a){try{a=textHtmlEncode(a);document.getElementById("debug").innerHTML=a}catch(b){}};